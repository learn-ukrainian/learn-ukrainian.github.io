
import yaml
import re

yaml_path = "curriculum/l2-uk-en/b2/activities/11-multi-clause-sentences.yaml"

# Replacements
quiz_replacements = {
    "Яке речення містить послідовне підпорядкування?": "Визначте, яке з наведених речень містить складну конструкцію з послідовним підпорядкуванням підрядних частин?",
    "Яке речення є прикладом однорідного підпорядкування?": "Яке з наведених нижче речень є класичним прикладом однорідного підпорядкування підрядних частин?",
    "Який сполучник є протиставним?": "Виберіть зі списку сполучник, який є протиставним і вживається для протиставлення частин речення?",
    "Яке речення містить неоднорідне (паралельне) підпорядкування?": "У якому з наведених речень використано неоднорідне (паралельне) підпорядкування підрядних частин?",
    "Яке речення містить вкладене підрядне?": "Знайдіть серед варіантів речення, яке містить вкладене підрядне речення всередині головного або іншого підрядного?",
    "Який тип підрядного відповідає на питання «чому?»": "Який граматичний тип підрядного речення зазвичай відповідає на логічне питання «чому?» або «з якої причини?»",
    "Яке речення є безсполучниковим?": "Яке з наведених складних речень є безсполучниковим, тобто частини якого поєднані лише інтонацією?",
    "Який сполучник вводить цільове підрядне?": "Який підрядний сполучник найчастіше вводить підрядне речення мети (цільове підрядне)?",
    
    # Complex Quiz
    "Яке речення є прикладом неоднорідного підпорядкування?": "Визначте, яке з наведених речень є прикладом неоднорідного (паралельного) підпорядкування кількох підрядних частин?",
    "Який сполучник НЕ є сполучником підрядності?": "Виберіть слово, яке НЕ є сполучником підрядності, а належить до сурядних сполучників або інших частин мови?",
    "Яке питання допомагає визначити цільове підрядне?": "Яке логічне питання допомагає правильно визначити підрядне речення мети (цільове підрядне)?",
    "У якому реченні правильно розставлені коми?": "У якому з наведених складних речень правильно розставлені всі розділові знаки (коми)?",
    "Яке речення містить спільний другорядний член?": "Яке складносурядне речення містить спільний другорядний член, що скасовує необхідність коми перед «і»?",
    "Що відрізняє безсполучникове речення від інших?": "Що саме принципово відрізняє безсполучникове складне речення від складносурядних та складнопідрядних речень?",
    "Яке питання відповідає допустовому підрядному?": "Яке логічне питання зазвичай ставиться до підрядного допустового речення?",
    "У якому реченні є три підрядних?": "У якому з наведених складних речень є щонайменше три підрядні частини?",
    "Яке речення граматично неправильне?": "Визначте, яке з наведених складних речень побудовано граматично або пунктуаційно неправильно?",
    
    # Select Activity (Needs checking too?)
    "Які речення мають правильну пунктуацію?": "Які з наведених складних речень мають абсолютно правильну пунктуацію відповідно до норм?",
    "Які речення є складнопідрядними?": "Виберіть усі речення, які за своєю структурою є складнопідрядними.",
    "Які речення містять означальне підрядне?": "Знайдіть речення, які містять означальне підрядне речення (відповідають на питання «який?»).",
    "Які речення містять послідовне підпорядкування?": "Виберіть речення, у яких наявне послідовне підпорядкування підрядних частин.",
    "Які сполучники є протиставними?": "Які з наведених сполучників належать до групи протиставних сурядних сполучників?",
    "Які речення не потребують коми перед «і»?": "У яких складносурядних реченнях не потрібно ставити кому перед сполучником «і»?",
    "Які типи підрядних відповідають на питання «чому?»": "Які типи підрядних речень відповідають на питання «чому?» або вказують на причину?",
    "Які речення є безсполучниковими?": "Які з наведених речень є безсполучниковими складними реченнями?"
}

# Update YAML
with open(yaml_path, 'r') as f:
    activities = yaml.safe_load(f)

for activity in activities:
    if activity['type'] in ['quiz', 'select']:
        for item in activity['items']:
            q = item['question']
            # Remove punctuation for matching? No, keys match exactly or close enough.
            # Try direct match
            if q in quiz_replacements:
                item['question'] = quiz_replacements[q]
            # Try stripping '?'
            elif q.rstrip('?') in quiz_replacements:
                item['question'] = quiz_replacements[q.rstrip('?')]

with open(yaml_path, 'w') as f:
    yaml.dump(activities, f, allow_unicode=True, sort_keys=False)

print("YAML fixed (Module 11).")

# Update Markdown Header (just in case)
md_path = "curriculum/l2-uk-en/b2/11-multi-clause-sentences.md"
with open(md_path, 'r') as f:
    md_content = f.read()

if "## Тест: Прочитайте текст" in md_content:
    md_content = md_content.replace("## Тест: Прочитайте текст", "## Вступ")
    with open(md_path, 'w') as f:
        f.write(md_content)
    print("Markdown header fixed.")
