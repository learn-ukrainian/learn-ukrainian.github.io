<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Module 02: The Cyrillic Code II | Ukrainian A1</title>
  <style>
:root { --primary: #1a5fb4; --primary-light: #3584e4; --success: #26a269; --warning: #e5a50a; --danger: #c01c28; --bg: #fafafa; --card-bg: #fff; --text: #1e1e1e; --text-muted: #5e5e5e; --border: #e0e0e0; }
* { box-sizing: border-box; margin: 0; padding: 0; }
body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif; background: var(--bg); color: var(--text); line-height: 1.6; }
.top-nav { background: #2e2e2e; color: white; padding: 0.5rem 2rem; display: flex; justify-content: space-between; align-items: center; font-size: 0.875rem; }
.top-nav a { color: white; text-decoration: none; }
.top-nav a:hover { text-decoration: underline; }
.module-nav { display: flex; gap: 1rem; align-items: center; }
.module-nav-link { color: rgba(255,255,255,0.8); text-decoration: none; padding: 0.25rem 0.5rem; }
.module-nav-link:hover { color: white; }
.module-nav-link.disabled { color: rgba(255,255,255,0.3); pointer-events: none; }
.nav { position: sticky; top: 0; background: var(--primary); color: white; padding: 1rem 2rem; display: flex; justify-content: space-between; align-items: center; z-index: 100; }
.nav h1 { font-size: 1.25rem; }
.nav-tabs { display: flex; gap: 0.5rem; }
.nav-tab { background: rgba(255,255,255,0.2); border: none; color: white; padding: 0.5rem 1rem; border-radius: 4px; cursor: pointer; }
.nav-tab.active { background: white; color: var(--primary); }
main { max-width: 1000px; margin: 0 auto; padding: 2rem; }
.section { display: none; } .section.active { display: block; }
.lesson-header { text-align: center; margin-bottom: 2rem; padding: 2rem; background: linear-gradient(135deg, #e8f4fd, #f0e8fd); border-radius: 12px; }
.level-badge { background: var(--primary); color: white; padding: 0.25rem 0.75rem; border-radius: 4px; font-size: 0.875rem; }
.card { background: var(--card-bg); border-radius: 12px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); padding: 1.5rem; margin-bottom: 1.5rem; }
.card h3 { color: var(--primary); margin-bottom: 1rem; }
.section-intro { border-left: 4px solid var(--primary); }
.section-intro h3 { color: var(--primary); }
.section-topic { border-left: 4px solid var(--border); }
.section-summary { background: linear-gradient(135deg, #f0f9ff, #e8f4fd); border-left: 4px solid var(--success); }
.section-summary h3 { color: var(--success); }
.canvas-note { background: #fffbeb; border-left: 4px solid var(--warning); padding: 1rem; margin: 1rem 0; border-radius: 0 8px 8px 0; }
.canvas-note h4 { color: var(--warning); margin-bottom: 0.5rem; }
.md-content { line-height: 1.7; }
.md-content p { margin: 0.75rem 0; }
.md-content ul, .md-content ol { margin: 0.75rem 0; padding-left: 1.5rem; }
.md-content li { margin: 0.25rem 0; }
.md-content strong { color: var(--primary); }
.md-content blockquote { background: #e8f4fd; border-left: 4px solid var(--primary); padding: 0.75rem 1rem; margin: 1rem 0; border-radius: 0 8px 8px 0; }
.md-content blockquote p { margin: 0.25rem 0; }
.md-content table { width: 100%; border-collapse: collapse; margin: 1rem 0; font-size: 0.9rem; }
.md-content th, .md-content td { border: 1px solid var(--border); padding: 0.5rem 0.75rem; text-align: left; }
.md-content th { background: #f5f5f5; font-weight: 600; }
.md-content code { background: #f0f0f0; padding: 0.125rem 0.375rem; border-radius: 4px; font-family: monospace; font-size: 0.9em; }
.md-content details { background: #f8f9fa; border: 1px solid var(--border); border-radius: 8px; padding: 0; margin: 1rem 0; }
.md-content details summary { background: linear-gradient(135deg, #e8f4fd, #f0e8fd); padding: 0.75rem 1rem; cursor: pointer; font-weight: 600; color: var(--primary); border-radius: 8px; list-style: none; display: flex; align-items: center; gap: 0.5rem; }
.md-content details summary::-webkit-details-marker { display: none; }
.md-content details summary::before { content: '‚ñ∂'; font-size: 0.75rem; transition: transform 0.2s; }
.md-content details[open] summary::before { transform: rotate(90deg); }
.md-content details[open] summary { border-radius: 8px 8px 0 0; }
.md-content details > *:not(summary) { padding: 0 1rem; }
.md-content details > *:last-child { padding-bottom: 1rem; }
.md-content p > details { margin: 0; }
.md-content p:has(> details) { margin: 1rem 0; }
.inline-answer { background: linear-gradient(135deg, #d4edda, #e8f4fd); padding: 0.125rem 0.5rem; border-radius: 4px; transition: opacity 0.2s; }
.inline-answer.hidden { opacity: 0; user-select: none; }
.answer-toggle-btn { display: inline-flex; align-items: center; gap: 0.5rem; background: linear-gradient(135deg, #e8f4fd, #f0e8fd); border: 1px solid var(--primary); color: var(--primary); padding: 0.5rem 1rem; border-radius: 8px; cursor: pointer; font-size: 0.875rem; font-weight: 600; margin: 1rem 0; }
.answer-toggle-btn:hover { background: var(--primary); color: white; }
.answer-toggle-btn svg { width: 1rem; height: 1rem; }
.letter-groups { display: grid; grid-template-columns: repeat(3, 1fr); gap: 1rem; margin: 1.5rem 0; }
.letter-group { border: 2px solid var(--border); border-radius: 8px; padding: 1rem; text-align: center; }
.letter-group.true-friends { border-color: var(--success); } .letter-group.true-friends .letters { color: var(--success); }
.letter-group.false-friends { border-color: var(--danger); } .letter-group.false-friends .letters { color: var(--danger); }
.letter-group.new-letters { border-color: var(--primary); } .letter-group.new-letters .letters { color: var(--primary); }
.letters { font-size: 1.75rem; letter-spacing: 0.3rem; }
.btn { padding: 0.75rem 1.5rem; border: none; border-radius: 8px; cursor: pointer; }
.btn-primary { background: var(--primary); color: white; }
.btn-outline { background: transparent; border: 2px solid var(--border); }
.btn-group { display: flex; gap: 1rem; justify-content: center; margin-top: 1.5rem; }
.score-display { text-align: center; padding: 1rem; background: linear-gradient(135deg, #e8f8f0, #e8f4fd); border-radius: 8px; margin-bottom: 1rem; }
.score-display .score { font-size: 2rem; font-weight: 700; color: var(--success); }
.completion-message { text-align: center; padding: 2rem; background: linear-gradient(135deg, #d4edda, #e8f4fd); border-radius: 12px; margin-top: 1rem; display: none; }
.completion-message.show { display: block; }
footer { text-align: center; padding: 2rem; color: var(--text-muted); }
@media (max-width: 768px) { .nav { flex-direction: column; gap: 1rem; } .letter-groups, .sort-groups, .quiz-options { grid-template-columns: 1fr; } .match-container { flex-direction: column; } }


/**
 * Layout styles - Navigation, page structure
 */

/* Top Navigation */
.top-nav {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 0.75rem 1.5rem;
  background: #f8f8f8;
  border-bottom: 1px solid var(--border);
  font-size: 0.875rem;
}

.top-nav a {
  color: var(--text-muted);
}

.top-nav a:hover {
  color: var(--primary);
}

.module-nav {
  display: flex;
  gap: 1rem;
}

.module-nav-link {
  padding: 0.25rem 0.5rem;
  border-radius: 4px;
}

.module-nav-link:hover {
  background: #e8f4fd;
}

/* Main Navigation */
.nav {
  background: linear-gradient(135deg, #1a5fb4, #613583);
  color: white;
  padding: 1.5rem 2rem;
  display: flex;
  justify-content: space-between;
  align-items: center;
}

.nav h1 {
  font-size: 1.5rem;
}

.nav-tabs {
  display: flex;
  gap: 0.5rem;
}

.nav-tab {
  background: rgba(255, 255, 255, 0.2);
  border: none;
  color: white;
  padding: 0.5rem 1rem;
  border-radius: 4px;
  cursor: pointer;
  font-size: 0.875rem;
  transition: background 0.2s;
}

.nav-tab:hover {
  background: rgba(255, 255, 255, 0.3);
}

.nav-tab.active {
  background: white;
  color: var(--primary);
}

/* Main Content */
main {
  max-width: 1000px;
  margin: 0 auto;
  padding: 2rem;
}

/* Sections */
.section {
  display: none;
}

.section.active {
  display: block;
}

/* Lesson Header */
.lesson-header {
  text-align: center;
  margin-bottom: 2rem;
  padding: 2rem;
  background: linear-gradient(135deg, #e8f4fd, #f0e8fd);
  border-radius: 12px;
}

.lesson-header h2 {
  font-size: 2rem;
  margin: 0.5rem 0;
}

/* Section Cards */
.section-intro {
  border-left: 4px solid var(--primary);
}

.section-intro h3 {
  color: var(--primary);
}

.section-topic {
  border-left: 4px solid var(--border);
}

.section-summary {
  background: linear-gradient(135deg, #f0f9ff, #e8f4fd);
  border-left: 4px solid var(--success);
}

.section-summary h3 {
  color: var(--success);
}

/* Canvas Notes */
.canvas-note {
  background: #fffbeb;
  border-left: 4px solid var(--warning);
  padding: 1rem;
  margin: 1rem 0;
  border-radius: 0 8px 8px 0;
}

.canvas-note h4 {
  color: var(--warning);
  margin-bottom: 0.5rem;
}

/* Footer */
footer {
  text-align: center;
  padding: 2rem;
  color: var(--text-muted);
}

/* Responsive Layout */
@media (max-width: 768px) {
  .nav {
    flex-direction: column;
    gap: 1rem;
  }

  .nav h1 {
    font-size: 1.25rem;
    text-align: center;
  }

  .nav-tabs {
    flex-wrap: wrap;
    justify-content: center;
  }

  main {
    padding: 1rem;
  }

  .top-nav {
    flex-direction: column;
    gap: 0.5rem;
  }
}


/* Match Activity */
.match-container { display: flex; gap: 3rem; padding: 1rem; position: relative; }
.match-column { flex: 1; display: flex; flex-direction: column; gap: 0.75rem; }
.match-item { background: var(--card-bg); border: 2px solid var(--border); border-radius: 8px; padding: 1rem; text-align: center; font-size: 1.25rem; cursor: pointer; }
.match-item.selected { border-color: var(--primary); background: #e8f4fd; }
.match-item.matched { border-color: var(--success); background: #e8f8f0; }
.match-item.wrong { border-color: var(--danger); background: #fde8e8; }
.match-lines { position: absolute; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; }

/* Quiz Activity */
.quiz-question { border: 1px solid var(--border); border-radius: 12px; padding: 1.5rem; margin-bottom: 1rem; }
.quiz-question.answered { pointer-events: none; }
.quiz-question .cyrillic { font-size: 1.5rem; color: var(--primary); font-weight: 600; }
.quiz-options { display: grid; grid-template-columns: repeat(2, 1fr); gap: 0.75rem; margin-top: 1rem; }
.quiz-option { background: #f5f5f5; border: 2px solid var(--border); border-radius: 8px; padding: 1rem; cursor: pointer; text-align: center; }
.quiz-option.correct { border-color: var(--success); background: #d4edda; }
.quiz-option.wrong { border-color: var(--danger); background: #f8d7da; }
.quiz-explanation { margin-top: 1rem; padding: 1rem; background: #e8f4fd; border-radius: 8px; display: none; }
.quiz-explanation.show { display: block; }

/* True/False Activity */
.tf-statement { border: 1px solid var(--border); border-radius: 12px; padding: 1.5rem; margin-bottom: 1rem; }
.tf-statement.answered { pointer-events: none; }
.tf-text { font-size: 1.15rem; margin-bottom: 1rem; }
.tf-buttons { display: flex; gap: 1rem; }
.tf-btn { flex: 1; background: #f5f5f5; border: 2px solid var(--border); border-radius: 8px; padding: 0.75rem 1rem; cursor: pointer; font-size: 1rem; font-weight: 500; }
.tf-btn:hover { background: #e8f4fd; border-color: var(--primary); }
.tf-btn.correct { border-color: var(--success); background: #d4edda; color: var(--success); }
.tf-btn.wrong { border-color: var(--danger); background: #f8d7da; color: var(--danger); }
.tf-explanation { margin-top: 1rem; padding: 1rem; background: #e8f4fd; border-radius: 8px; display: none; }
.tf-explanation.show { display: block; }

/* Sort Activity */
.sort-pool { background: #f5f5f5; border: 2px dashed var(--border); border-radius: 12px; padding: 1.5rem; min-height: 80px; margin-bottom: 1rem; }
.sort-items { display: flex; flex-wrap: wrap; gap: 0.5rem; justify-content: center; }
.sort-item { background: var(--card-bg); border: 2px solid var(--border); border-radius: 8px; padding: 0.75rem 1.25rem; font-size: 1.5rem; cursor: grab; }
.sort-item.correct { border-color: var(--success); background: #e8f8f0; }
.sort-item.wrong { border-color: var(--danger); background: #fde8e8; }
.sort-groups { display: grid; grid-template-columns: repeat(3, 1fr); gap: 1rem; }
.sort-group { border: 2px solid var(--border); border-radius: 12px; padding: 1rem; min-height: 150px; }
.sort-group.drag-over { border-color: var(--primary); background: #e8f4fd; }
.sort-group h4 { font-size: 0.875rem; text-align: center; margin-bottom: 1rem; padding-bottom: 0.5rem; border-bottom: 2px solid var(--border); }
.sort-group.true-friends h4 { color: var(--success); border-color: var(--success); }
.sort-group.false-friends h4 { color: var(--danger); border-color: var(--danger); }
.sort-group.new-letters h4 { color: var(--primary); border-color: var(--primary); }

/* Vocabulary Grid (legacy) */
.vocab-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(180px, 1fr)); gap: 1rem; }
.vocab-card { border: 1px solid var(--border); border-radius: 12px; padding: 1.25rem; text-align: center; }
.vocab-card .uk { font-size: 1.75rem; font-weight: 600; color: var(--primary); }
.vocab-card .translit { color: var(--text-muted); font-style: italic; }
.vocab-card .en { font-weight: 500; margin: 0.25rem 0; }
.vocab-card .note { font-size: 0.75rem; color: #613583; background: #f0e8fd; padding: 0.25rem 0.5rem; border-radius: 4px; }

/* Vocabulary Table (book-style) */
.vocab-table-container { overflow-x: auto; }
.vocab-table { width: 100%; border-collapse: collapse; font-size: 1rem; }
.vocab-table thead { background: var(--card-bg); border-bottom: 2px solid var(--border); }
.vocab-table th { padding: 0.75rem 1rem; text-align: left; font-weight: 600; color: var(--text-muted); font-size: 0.875rem; text-transform: uppercase; letter-spacing: 0.5px; }
.vocab-table td { padding: 0.75rem 1rem; border-bottom: 1px solid var(--border); }
.vocab-table tbody tr:hover { background: #f8f9fa; }
.vocab-table .vocab-uk { font-size: 1.25rem; font-weight: 600; color: var(--primary); }
.vocab-table .vocab-translit { color: var(--text-muted); font-style: italic; }
.vocab-table .vocab-ipa { font-family: monospace; color: var(--text-muted); font-size: 0.9rem; }
.vocab-table .vocab-en { font-weight: 500; }
.vocab-table .vocab-note { font-size: 0.85rem; color: #613583; }

/* Answer Callout Blocks */
.callout { padding: 0.5rem 1rem; margin: 0.25rem 0; border-radius: 4px; }
.callout-answer { background: #e8f8f0; border-left: 3px solid var(--success); }
.callout-explanation { background: #e8f4fd; border-left: 3px solid var(--primary); color: var(--text-muted); font-style: italic; }
.callout-alt { background: #f5f5f5; border-left: 3px solid var(--border); color: var(--text-muted); }

/* Answer Block Toggle */
.answer-block { display: none; }
.answer-block.show { display: block; }
.show-answer-btn { background: #f0f0f0; border: 1px solid var(--border); border-radius: 6px; padding: 0.25rem 0.75rem; font-size: 0.8rem; cursor: pointer; color: var(--text-muted); margin: 0.25rem 0; }
.show-answer-btn:hover { background: #e5e5e5; }
.show-answer-btn.revealed { background: #e8f8f0; border-color: var(--success); color: var(--success); }

/* Fill-in Activity - Dropdown in Sentence */
.fill-container { display: flex; flex-direction: column; gap: 0.75rem; }
.fill-question { border: 1px solid var(--border); border-radius: 12px; padding: 1rem 1.5rem; }

.fill-number { font-weight: 600; color: var(--text-muted); margin-right: 0.5rem; }
.fill-sentence { font-size: 1.15rem; line-height: 1.8; }

.fill-dropdown { font-size: 1rem; padding: 0.4rem 0.6rem; border: 2px solid var(--primary); border-radius: 6px; background: #fff; color: var(--primary); font-weight: 500; cursor: pointer; min-width: 120px; }
.fill-dropdown:focus { outline: none; box-shadow: 0 0 0 3px rgba(26, 115, 232, 0.2); }
.fill-dropdown.correct { border-color: var(--success); background: #e8f8f0; color: var(--success); }
.fill-dropdown.wrong { border-color: var(--danger); background: #fde8e8; color: var(--danger); }

.fill-feedback { margin-top: 0.5rem; font-weight: 500; }
.fill-feedback .correct-text { color: var(--success); }
.fill-feedback .wrong-text { color: var(--danger); }
.btn-sm { padding: 0.5rem 1rem; font-size: 0.875rem; }

/* Order/Unjumble Activity */
.order-container { display: flex; flex-direction: column; gap: 1rem; }
.order-items { display: flex; flex-direction: column; gap: 0.5rem; margin-bottom: 1rem; }
.order-item { background: var(--card-bg); border: 2px solid var(--border); border-radius: 8px; padding: 1rem; display: flex; align-items: center; gap: 1rem; cursor: grab; user-select: none; }
.order-item:active { cursor: grabbing; }
.order-item.dragging { opacity: 0.5; }
.order-item.correct { border-color: var(--success); background: #e8f8f0; }
.order-item.wrong { border-color: var(--danger); background: #fde8e8; }
.order-handle { color: var(--text-muted); font-size: 1.25rem; }
.order-text { font-size: 1.1rem; }

/* Unjumble Activity - Drag and Drop */
.unjumble-question { border: 1px solid var(--border); border-radius: 12px; padding: 1rem 1.5rem; margin-bottom: 0.75rem; display: flex; flex-wrap: wrap; align-items: center; gap: 0.75rem; }
.unjumble-question.answered .unjumble-word { cursor: default; }
.unjumble-question.correct { border-color: var(--success); background: #f8fff8; }
.unjumble-question.wrong { border-color: var(--danger); background: #fff8f8; }

.unjumble-number { font-weight: 600; color: var(--text-muted); min-width: 2rem; }

.unjumble-word-row { display: flex; flex-wrap: wrap; gap: 0.5rem; flex: 1; min-height: 42px; padding: 0.25rem; border-radius: 8px; background: #f8f9fa; }
.unjumble-word-row.correct { background: #e8f8f0; }
.unjumble-word-row.wrong { background: #fde8e8; }

.unjumble-word { background: var(--primary); color: white; border-radius: 6px; padding: 0.5rem 0.75rem; font-size: 1rem; cursor: grab; user-select: none; transition: transform 0.1s, box-shadow 0.1s; }
.unjumble-word:hover { transform: translateY(-2px); box-shadow: 0 4px 8px rgba(0,0,0,0.15); }
.unjumble-word:active { cursor: grabbing; }
.unjumble-word.dragging { opacity: 0.5; transform: scale(1.05); }

.unjumble-word.touch-clone { position: fixed; z-index: 1000; pointer-events: none; box-shadow: 0 8px 16px rgba(0,0,0,0.2); }

.unjumble-actions { display: flex; gap: 0.5rem; }
.unjumble-feedback { width: 100%; padding: 0.5rem 0 0 2.5rem; display: none; }
.unjumble-feedback.show { display: block; }
.unjumble-feedback .correct-text { color: var(--success); font-weight: 600; }
.unjumble-feedback .wrong-text { color: var(--danger); }
.unjumble-feedback .translation { color: var(--text-muted); font-style: italic; margin-left: 0.5rem; }

/* Order Sentence Activity - Sentence reordering with unjumble-style UI */
.order-sequence { display: flex; flex-direction: column; align-items: stretch; }
.order-sentence-row { display: flex; flex-direction: column; flex-wrap: nowrap; gap: 0.5rem; min-height: auto; padding: 0.5rem; flex: none; width: 100%; }
.order-sentence-item { background: var(--primary); color: white; border-radius: 8px; padding: 0.75rem 1rem; font-size: 1rem; cursor: grab; user-select: none; display: flex; align-items: center; gap: 0.75rem; transition: transform 0.1s, box-shadow 0.1s; }
.order-sentence-item:hover { transform: translateY(-2px); box-shadow: 0 4px 8px rgba(0,0,0,0.15); }
.order-sentence-item:active { cursor: grabbing; }
.order-sentence-item.dragging { opacity: 0.5; transform: scale(1.02); }
.order-sentence-item.correct { background: var(--success); }
.order-sentence-item.wrong { background: var(--danger); }
.order-sentence-item.touch-clone { position: fixed; z-index: 1000; pointer-events: none; box-shadow: 0 8px 16px rgba(0,0,0,0.2); max-width: 90vw; }
.order-num { background: rgba(255,255,255,0.3); padding: 0.25rem 0.5rem; border-radius: 4px; font-weight: 600; min-width: 1.5rem; text-align: center; }
.order-sentence-text { flex: 1; }
.order-feedback { width: 100%; padding: 0.5rem 0; display: none; }
.order-feedback.show { display: block; }
.order-feedback .correct-text { color: var(--success); font-weight: 600; }
.order-feedback .wrong-text { color: var(--danger); }

/* Order Card Activity - New class names for classic order */
.order-items-wrapper { display: flex; flex-direction: column; gap: 0.5rem; margin-bottom: 1rem; }
.order-sentence-card { background: var(--primary); color: white; border-radius: 8px; padding: 0.75rem 1rem; font-size: 1rem; cursor: grab; user-select: none; display: flex; align-items: center; gap: 0.75rem; transition: transform 0.1s, box-shadow 0.1s; }
.order-sentence-card:hover { transform: translateY(-2px); box-shadow: 0 4px 8px rgba(0,0,0,0.15); }
.order-sentence-card:active { cursor: grabbing; }
.order-sentence-card.dragging { opacity: 0.5; transform: scale(1.02); }
.order-sentence-card.correct { background: var(--success); }
.order-sentence-card.wrong { background: var(--danger); }
.order-card-num { background: rgba(255,255,255,0.3); padding: 0.25rem 0.5rem; border-radius: 4px; font-weight: 600; min-width: 1.5rem; text-align: center; }
.order-card-text { flex: 1; }
.order-buttons { margin-top: 0.5rem; }

/* Select Activity - Multi-choice checkboxes */
.select-container { display: flex; flex-direction: column; gap: 1rem; }
.select-question { border: 1px solid var(--border); border-radius: 12px; padding: 1.25rem; display: flex; gap: 0.75rem; }
.select-question.answered .select-checkbox { pointer-events: none; }
.select-number { font-weight: 600; color: var(--text-muted); min-width: 2rem; }
.select-content { flex: 1; }
.select-prompt { font-size: 1.1rem; font-weight: 500; margin-bottom: 0.75rem; }
.select-options { display: flex; flex-direction: column; gap: 0.5rem; margin-bottom: 0.75rem; }
.select-option { display: flex; align-items: center; gap: 0.75rem; padding: 0.5rem 0.75rem; border-radius: 6px; cursor: pointer; transition: background 0.15s; }
.select-option:hover { background: #f5f5f5; }
.select-option.correct { background: #d4edda; }
.select-option.correct-unchecked { background: #f8f9fa; }
.select-option.wrong { background: #f8d7da; }
.select-option.missed { background: #fff3cd; border: 1px dashed var(--warning); }
.select-checkbox { width: 1.25rem; height: 1.25rem; cursor: pointer; }
.select-text { font-size: 1rem; }
.select-check { margin-top: 0.5rem; }
.select-feedback { margin-top: 0.75rem; display: none; }
.select-feedback.show { display: block; }
.select-feedback .correct-text { color: var(--success); font-weight: 600; }
.select-feedback .wrong-text { color: var(--danger); }

/* Anagram Activity - Letter reordering to form words */
.anagram-question { border: 1px solid var(--border); border-radius: 12px; padding: 1rem 1.5rem; margin-bottom: 0.75rem; display: flex; flex-wrap: wrap; align-items: center; gap: 0.75rem; }
.anagram-question.answered .anagram-letter { cursor: default; }
.anagram-question.correct { border-color: var(--success); background: #f8fff8; }
.anagram-question.wrong { border-color: var(--danger); background: #fff8f8; }

.anagram-number { font-weight: 600; color: var(--text-muted); min-width: 2rem; }

.anagram-letter-row { display: flex; flex-wrap: wrap; gap: 0.35rem; flex: 1; min-height: 52px; padding: 0.25rem; border-radius: 8px; background: #f8f9fa; }
.anagram-letter-row.correct { background: #e8f8f0; }
.anagram-letter-row.wrong { background: #fde8e8; }

.anagram-letter { background: var(--primary); color: white; border-radius: 8px; padding: 0.6rem 0.9rem; font-size: 1.5rem; font-weight: 600; cursor: grab; user-select: none; transition: transform 0.1s, box-shadow 0.1s; min-width: 2.5rem; text-align: center; }
.anagram-letter:hover { transform: translateY(-2px); box-shadow: 0 4px 8px rgba(0,0,0,0.15); }
.anagram-letter:active { cursor: grabbing; }
.anagram-letter.dragging { opacity: 0.5; transform: scale(1.05); }

.anagram-letter.touch-clone { position: fixed; z-index: 1000; pointer-events: none; box-shadow: 0 8px 16px rgba(0,0,0,0.2); }

.anagram-actions { display: flex; gap: 0.5rem; }
.anagram-feedback { width: 100%; padding: 0.5rem 0 0 2.5rem; display: none; }
.anagram-feedback.show { display: block; }
.anagram-feedback .correct-text { color: var(--success); font-weight: 600; }
.anagram-feedback .wrong-text { color: var(--danger); }
.anagram-feedback .translation { color: var(--text-muted); font-style: italic; margin-left: 0.5rem; }

/* Error-Correction Activity - Identify and fix errors */
.error-correction-container { display: flex; flex-direction: column; gap: 0.75rem; }
.error-item { border: 1px solid var(--border); border-radius: 12px; padding: 1rem 1.5rem; margin-bottom: 0.5rem; }
.error-item.completed { opacity: 0.85; }
.error-item.step2 .error-words { background: #f0f9ff; }

.error-sentence { display: flex; align-items: baseline; gap: 0.5rem; font-size: 1.15rem; line-height: 1.8; flex-wrap: wrap; }
.error-number { font-weight: 600; color: var(--text-muted); min-width: 2rem; }
.error-words { display: inline; }

.error-word { cursor: pointer; padding: 0.15rem 0.25rem; border-radius: 4px; transition: background 0.15s, color 0.15s; }
.error-word:hover { background: #e8f4fd; }
.error-word.selected { background: var(--primary); color: white; }
.error-word.found { background: var(--success); color: white; cursor: default; }
.error-word.wrong-selection { background: var(--danger); color: white; animation: shake 0.3s; }
.error-item.completed .error-word { cursor: default; }
.error-item.completed .error-word:hover { background: transparent; }
.error-item.completed .error-word.found { background: var(--success); color: white; }

@keyframes shake {
  0%, 100% { transform: translateX(0); }
  25% { transform: translateX(-4px); }
  75% { transform: translateX(4px); }
}

.error-no-error-btn { margin-top: 0.75rem; }
.error-options { margin-top: 0.75rem; }
.error-prompt { font-weight: 500; color: var(--text-muted); display: block; margin-bottom: 0.5rem; }
.error-option-btns { display: flex; flex-wrap: wrap; gap: 0.5rem; }
.error-option { background: #f5f5f5; border: 2px solid var(--border); border-radius: 8px; padding: 0.5rem 1rem; cursor: pointer; font-size: 1rem; }
.error-option:hover { border-color: var(--primary); background: #e8f4fd; }
.error-option:disabled { cursor: default; }
.error-option.correct { border-color: var(--success); background: #d4edda; color: var(--success); }
.error-option.wrong { border-color: var(--danger); background: #f8d7da; color: var(--danger); }

.error-feedback { margin-top: 0.75rem; padding: 0.75rem 1rem; border-radius: 8px; background: #f8f9fa; }
.error-feedback .correct-text { color: var(--success); font-weight: 600; }
.error-feedback .wrong-text { color: var(--danger); }
.error-explanation { margin-top: 0.5rem; color: var(--text-muted); font-style: italic; font-size: 0.95rem; }

  </style>
</head>
<body>
  
  <div class="top-nav">
    <a href="../index.html">‚Üê l2-uk-en Curriculum</a>
    <div class="module-nav">
      <a href="module-01.html" class="module-nav-link">‚Üê Module 01</a>
      <a href="index.html" class="module-nav-link">A1 Index</a>
      <a href="module-03.html" class="module-nav-link">Module 03 ‚Üí</a>
    </div>
  </div>
  <nav class="nav">
    <h1>Module 02: The Cyrillic Code II</h1>
    <div class="nav-tabs">
      <button class="nav-tab active" data-section="lesson">Lesson</button>
      <button class="nav-tab" data-section="activity-0">1. Match</button>
      <button class="nav-tab" data-section="activity-1">2. Quiz</button>
      <button class="nav-tab" data-section="activity-2">3. Match</button>
      <button class="nav-tab" data-section="activity-3">4. Sort</button>
      <button class="nav-tab" data-section="activity-4">5. Fill</button>
      <button class="nav-tab" data-section="activity-5">6. Order</button>
      <button class="nav-tab" data-section="activity-6">7. Quiz</button>
      <button class="nav-tab" data-section="activity-7">8. Spell</button>
      <button class="nav-tab" data-section="activity-8">9. T/F</button>
      <button class="nav-tab" data-section="vocab">Vocab</button>
    </div>
  </nav>
  <main>
    
    <section id="lesson" class="section active">
      <div class="lesson-header">
        <span class="level-badge">A1 ¬∑ A1.1</span>
        <h2 style="font-size:2rem;margin:0.5rem 0">The Cyrillic Code II</h2>
        <p style="color:var(--text-muted)">The Aliens, The Hissers, and The Soft Sign</p>
      </div>
      
    <div class="card section-intro">
      <h3>üìñ Introduction</h3>
      <div class="md-content"><h2 id="warmup">warm-up</h2>
<p><strong>Entering the Alien Territory: The Sound of Ukrainian Identity.</strong></p>
<p>In Module 01, we built a foundation with familiar letters, the "True Friends," and demystified the "False Friends" that look like English but sound different. Now, we embark on the final, most exciting stage of our journey into the Ukrainian alphabet: meeting the true "Aliens."</p>
<p>These are the letters that initially look like enigmatic squiggles, symbols from another galaxy: <strong>–ñ, –©, –Ñ, –Æ</strong>. They don't resemble anything in the Latin alphabet, and that's precisely their beauty and power. These unique symbols carry the very essence of Ukrainian phonology, shaping its melody, rhythm, and distinct character. They are not merely letters; they are gateways to the authentic sound of Ukraine, sounds that you will soon learn to love and produce with confidence.</p>
<p>This module is where the alphabet truly comes alive. We will master the rich, textured "Hissing Sounds" that are a hallmark of Slavic languages. You will learn the "Y-Vowels," which introduce a beautiful softness and fluidity to words. We will tackle the subtle but crucial distinction between the two Ukrainian 'H' sounds (one breathy, one hard). And finally, we will unlock the secret of the "Soft Sign" (–¨) and the "Hard I" (–ò), which subtly but profoundly shape pronunciation.</p>
<p>By the end of this intensive session, you will not only recognize every letter of the Ukrainian alphabet but also understand their phonetic nuances. This mastery will enable you to read <em>any</em> Ukrainian word with confidence, whether it's a street sign in Kyiv, a newspaper headline, or the lyrics of a folk song. Get ready to truly hear and produce the sounds of Ukraine!</p>
<h2 id="presentation">presentation</h2>
<h3 id="group1thehissingbuzzingandwhooshingsoundssibilantsaffricates">Group 1: The Hissing, Buzzing, and Whooshing Sounds (Sibilants &amp; Affricates)</h3>
<p>These are some of the most characteristic sounds of Ukrainian, often referred to as sibilants and affricates. They add a unique texture and richness to the language, making it distinct from many Western European tongues. Don't be shy; embrace the hiss, the buzz, and the whoosh!</p>
<table>
<thead>
<tr>
<th>Letter</th>
<th>Sound (IPA)</th>
<th>English Approximation</th>
<th>Shape Mnemonic</th>
<th>Example</th>
<th>English Translation</th>
<th>Audio</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>–ñ –∂</strong></td>
<td>/ í/</td>
<td>Like <strong>s</strong> in plea<strong>s</strong>ure</td>
<td>A beetle (Zzhhh!)</td>
<td><strong>–ñ</strong>—É–∫</td>
<td>Beetle</td>
<td><button class="audio-btn" onclick="openForvo('zh')" title="Listen on Forvo (Search)">üîä</button></td>
</tr>
<tr>
<td><strong>–® —à</strong></td>
<td>/ É/</td>
<td>Like <strong>sh</strong> in <strong>sh</strong>e</td>
<td>A pitchfork</td>
<td><strong>–®</strong>–æ–∫–æ–ª–∞–¥</td>
<td>Chocolate</td>
<td><button class="audio-btn" onclick="openForvo('sh')" title="Listen on Forvo (Search)">üîä</button></td>
</tr>
<tr>
<td><strong>–ß —á</strong></td>
<td>/t É/</td>
<td>Like <strong>ch</strong> in <strong>ch</strong>air</td>
<td>An upside-down chair</td>
<td><strong>–ß</strong>–∞–π</td>
<td>Tea</td>
<td><button class="audio-btn" onclick="openForvo('ch')" title="Listen on Forvo (Search)">üîä</button></td>
</tr>
<tr>
<td><strong>–© —â</strong></td>
<td>/ Ét É/</td>
<td>Like <strong>sh</strong> + <strong>ch</strong> (as in fre<strong>sh ch</strong>eese)</td>
<td>Fork with a tail</td>
<td><strong>–©</strong>–æ</td>
<td>What</td>
<td><button class="audio-btn" onclick="openForvo('shch')" title="Listen on Forvo (Search)">üîä</button></td>
</tr>
<tr>
<td><strong>–¶ —Ü</strong></td>
<td>/ts/</td>
<td>Like <strong>ts</strong> in ca<strong>ts</strong></td>
<td>U with a tail</td>
<td><strong>–¶</strong>–µ</td>
<td>This is</td>
<td><button class="audio-btn" onclick="openForvo('ts')" title="Listen on Forvo (Search)">üîä</button></td>
</tr>
<tr>
<td><strong>–î–ñ –¥–∂</strong></td>
<td>/d í/</td>
<td>Like <strong>j</strong> in <strong>j</strong>am (digraph)</td>
<td>D + Zh</td>
<td><strong>–î–∂</strong>–∞–∑</td>
<td>Jazz</td>
<td><button class="audio-btn" onclick="openForvo('dj')" title="Listen on Forvo (Search)">üîä</button></td>
</tr>
<tr>
<td><strong>–î–ó –¥–∑</strong></td>
<td>/dz/</td>
<td>Like <strong>ds</strong> in po<strong>ds</strong></td>
<td>D + Z</td>
<td><strong>–î–∑</strong>–≤—ñ–Ω</td>
<td>Bell</td>
<td><button class="audio-btn" onclick="openForvo('dz')" title="Listen on Forvo (Search)">üîä</button></td>
</tr>
</tbody>
</table>
<blockquote>
  <p>‚ö° <strong>Pro Tip: Distinguishing –® (Sh) vs –© (Shch)</strong><br />
  Many learners confuse these, but in Ukrainian, they are completely distinct and affect meaning.</p>
  <ul>
  <li><strong>–®</strong> (Sh): This is a simple, singular "shhh" sound, like telling someone to be quiet.</li>
  <li><strong>–©</strong> (Shch): This is a <strong>two-part sound</strong> ‚Äì a rapid sequence of "sh" followed by "ch". Think of the sound in "fre<strong>sh ch</strong>eese" or "wa<strong>sh ch</strong>othes." It's longer, more complex, and definitely "crunchier." Practice saying "Sh-ch!" together quickly.<br />
  Mastering this distinction is a key step towards authentic Ukrainian pronunciation.</li>
  </ul>
</blockquote>
<h3 id="group2theyvowelsiotated">Group 2: The "Y" Vowels (Iotated)</h3>
<p>These four vowels are magical. They each have an invisible "Y" sound ([j] in IPA) built into them. This "Y" sound softens the preceding consonant (if there is one) or appears at the beginning of the word if no consonant precedes. They are crucial for the inherent melodic quality of Ukrainian.</p>
<table>
<thead>
<tr>
<th>Letter</th>
<th>Sound (IPA)</th>
<th>English Approximation</th>
<th>Rules</th>
<th>Example</th>
<th>English Translation</th>
<th>Audio</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>–Ñ —î</strong></td>
<td>/j…õ/</td>
<td><strong>Ye</strong>s</td>
<td>Y + E</td>
<td><strong>–Ñ</strong>–≤—Ä–æ–ø–∞</td>
<td>Europe</td>
<td><button class="audio-btn" onclick="openForvo('ye')" title="Listen on Forvo (Search)">üîä</button></td>
</tr>
<tr>
<td><strong>–á —ó</strong></td>
<td>/ji/</td>
<td><strong>Yie</strong>ld</td>
<td>Y + I</td>
<td>–£–∫—Ä–∞<strong>—ó</strong>–Ω–∞</td>
<td>Ukraine</td>
<td><button class="audio-btn" onclick="openForvo('yi')" title="Listen on Forvo (Search)">üîä</button></td>
</tr>
<tr>
<td><strong>–Æ —é</strong></td>
<td>/ju/</td>
<td><strong>You</strong></td>
<td>Y + U</td>
<td><strong>–Æ</strong>–øi—Ç–µ—Ä</td>
<td>Jupiter</td>
<td><button class="audio-btn" onclick="openForvo('yu')" title="Listen on Forvo (Search)">üîä</button></td>
</tr>
<tr>
<td><strong>–Ø —è</strong></td>
<td>/j…ë/</td>
<td><strong>Ya</strong>rd</td>
<td>Y + A</td>
<td><strong>–Ø</strong></td>
<td>I</td>
<td><button class="audio-btn" onclick="openForvo('ya')" title="Listen on Forvo (Search)">üîä</button></td>
</tr>
</tbody>
</table>
<blockquote>
  <p>üí° <strong>Did You Know? The Power of –á</strong><br />
  The letter <strong>–á</strong> (Yi) is a unique and cherished symbol of Ukrainian language and identity. It is absent in Russian and other Slavic languages that use Cyrillic (which use variations of 'i' or 'y'). The presence of <strong>–á</strong> often signifies a true Ukrainian word and its sound contributes to the language's melodic flow. In cities like Mariupol, <strong>–á</strong> has even been used as a powerful symbol of cultural resistance and defiance against Russification. When you see those two dots, remember: it's <em>always</em> "Yee," a clear, strong sound.</p>
</blockquote>
<h3 id="group3thetrickypairgvsh">Group 3: The Tricky Pair (G vs H)</h3>
<p>This distinction is vital and often challenging for English speakers, as English only has one 'H' sound and one 'G' sound. Ukrainian has two distinct sounds that often get confused.</p>
<ul>
<li><strong>–ì –≥</strong> (The Hook) = /…¶/. This is a breathy, voiced "H" sound. Think of the soft 'h' in "a<strong>h</strong>ead" or the Scottish 'ch' in "lo<strong>ch</strong>" but voiced. Your throat vibrates slightly. It's much softer than the English 'G'.<ul>
<li><em>Example:</em> <strong>–ì</strong>–æ–ª–æ—Å (Holos - Voice), <strong>–ì</strong>–æ—Ç–µ–ª—å (Hotel).</li></ul></li>
<li><strong>“ê “ë</strong> (The Hook with a Hat) = /g/. This is the hard, explosive "G" sound, exactly like the 'g' in "<strong>g</strong>o" or "<strong>g</strong>ood". It's less common in Ukrainian but crucial for proper pronunciation of some loanwords.<ul>
<li><em>Example:</em> <strong>“ê</strong>—É–¥–∑–∏–∫ (Gudzyk - Button), <strong>“ê</strong>—É–≥–ª (Google).</li></ul></li>
</ul>
<blockquote>
  <p>‚ö° <strong>Pro Tip: Practice –ì (H) vs “ê (G)</strong><br />
  Try saying "Hamburger." The initial 'H' sound is similar to Ukrainian <strong>–ì</strong>. Now try "Google." The initial 'G' is Ukrainian <strong>“ê</strong>. Consciously producing these distinct sounds is essential for accuracy at this level.</p>
</blockquote>
<h3 id="group4thesilentmodifiersthehardvowel">Group 4: The Silent Modifiers &amp; The Hard Vowel</h3>
<p>These letters don't make new sounds but subtly (or not so subtly) influence the sounds around them.</p>
<ul>
<li><p><strong>–¨</strong> (Soft Sign). This tiny symbol has <strong>no sound</strong> of its own. Its only job is to tell you that the consonant <em>before</em> it should be pronounced "soft" (palatalized). Think of the 'ny' in "o<strong>ny</strong>on" for a soft 'n'.</p>
<ul>
<li><em>Example:</em> <strong>–ù</strong> (hard N) vs. <strong>–ù–¨</strong> (soft N). <strong>–õ</strong> (hard L) vs. <strong>–õ–¨</strong> (soft L, like in 'li' in 'million').</li>
<li>The soft sign is a fundamental part of Ukrainian phonology and contributes to its unique melodic quality.</li></ul></li>
<li><p><strong>–ò</strong> (Hard I). This letter often looks like a backwards 'N' or a rotated 'H'. It is pronounced /…™/, similar to the 'i' in "s<strong>i</strong>t" or the 'u' in "b<strong>u</strong>sh". It's a deep, central vowel sound, distinct from <strong>–Ü</strong> (which is a clear "ee" as in "machine").</p>
<ul>
<li><em>Example:</em> <strong>–ö–ò–á–í</strong> (Kyiv - note the '–ò' then '–á'), <strong>–†–ò–ë–ê</strong> (Ryba - Fish).</li>
<li><strong>CRITICAL:</strong> Do NOT confuse <strong>–ò</strong> with <strong>–Ü</strong>. They are different sounds, and using one for the other will make words unintelligible.</li></ul></li>
</ul>
<blockquote>
  <p>üîç <strong>The "Italic" Warning: Hand-Written Transformations</strong><br />
  When reading handwritten Ukrainian or certain stylized fonts (especially italics), many Cyrillic letters magically transform, often resembling Latin letters. This can be very confusing, but context and practice will help you.</p>
  <ul>
  <li><strong>—Ç</strong> (print) often looks like a handwritten <em>m</em></li>
  <li><strong>–ø</strong> (print) often looks like a handwritten <em>n</em></li>
  <li><strong>–¥</strong> (print) often looks like a handwritten <em>g</em></li>
  <li><strong>–∏</strong> (print) often looks like a handwritten <em>u</em></li>
  <li><strong>–≥</strong> (print) often looks like a handwritten <em>backward 's'</em> or <em>‚àÇ</em></li>
  <li><strong>–ª</strong> (print) often looks like a handwritten <em>inverted v</em> or <em>hook</em></li>
  <li><strong>—à</strong> (print) often looks like a handwritten <em>w</em><br />
  Don't panic if you see these; simply remember the original sound and you'll be able to decode it.</li>
  </ul>
</blockquote>
<h2 id="practice">practice</h2>
<p>Let's apply our full alphabet knowledge to some essential Ukrainian survival phrases and common words. Focus on articulating the unique sounds we just learned.</p>
<p><strong>1. Greetings & Politeness (Revisited):</strong></p>
<ul>
<li><strong>–ü–†–ò–í–Ü–¢</strong> <button class="audio-btn" onclick="openForvo('–ü–†–ò–í–Ü–¢')" title="Listen on Forvo">üîä</button> (Pry-vit) ‚Äî Hi / Hello (Informal). Note the soft <strong>–í</strong> and <strong>–¢–¨</strong>.</li>
<li><strong>–î–Ø–ö–£–Æ</strong> <button class="audio-btn" onclick="openForvo('–î–Ø–ö–£–Æ')" title="Listen on Forvo">üîä</button> (Dya-ku-yu) ‚Äî Thank you. The <strong>–î–Ø</strong> has a distinct 'y' glide.</li>
<li><strong>–ë–£–î–¨ –õ–ê–°–ö–ê</strong> <button class="audio-btn" onclick="openForvo('–ë–£–î–¨ –õ–ê–°–ö–ê')" title="Listen on Forvo">üîä</button> (Bud' las-ka) ‚Äî Please / You're welcome. The <strong>–î–¨</strong> is a soft 'd'.</li>
<li><strong>–î–û –ü–û–ë–ê–ß–ï–ù–ù–Ø</strong> <button class="audio-btn" onclick="openForvo('–î–û –ü–û–ë–ê–ß–ï–ù–ù–Ø')" title="Listen on Forvo">üîä</button> (Do po-ba-chen-nya) ‚Äî Goodbye. Note the <strong>–ß</strong> and soft <strong>–ù–ù–Ø</strong>.</li>
<li><strong>–í–ò–ë–ê–ß–¢–ï</strong> <button class="audio-btn" onclick="openForvo('–í–ò–ë–ê–ß–¢–ï')" title="Listen on Forvo">üîä</button> (Vy-bach-te) ‚Äî Excuse me / Sorry. Hear the <strong>–ß</strong>.</li>
</ul>
<p><strong>2. Essential Question Words (The Inquisitors):</strong></p>
<ul>
<li><strong>–©–û</strong> <button class="audio-btn" onclick="openForvo('–©–û')" title="Listen on Forvo">üîä</button> (Shcho) ‚Äî What? This is one of the most common words ‚Äì master that <strong>–©</strong> sound!</li>
<li><strong>–î–ï</strong> <button class="audio-btn" onclick="openForvo('–î–ï')" title="Listen on Forvo">üîä</button> (De) ‚Äî Where? Simple.</li>
<li><strong>–•–¢–û</strong> <button class="audio-btn" onclick="openForvo('–•–¢–û')" title="Listen on Forvo">üîä</button> (Khto) ‚Äî Who? Remember the hard <strong>–•</strong>.</li>
<li><strong>–Ø–ö</strong> <button class="audio-btn" onclick="openForvo('–Ø–ö')" title="Listen on Forvo">üîä</button> (Yak) ‚Äî How?</li>
<li><strong>–ß–ò–ô</strong> <button class="audio-btn" onclick="openForvo('–ß–ò–ô')" title="Listen on Forvo">üîä</button> (Chiy) ‚Äî Whose?</li>
<li><strong>–ß–û–ú–£</strong> <button class="audio-btn" onclick="openForvo('–ß–û–ú–£')" title="Listen on Forvo">üîä</button> (Chomu) ‚Äî Why?</li>
</ul>
<p><strong>3. Common Ukrainian Words with New Letters:</strong></p>
<ul>
<li><strong>–ë–û–†–©</strong> <button class="audio-btn" onclick="openForvo('–ë–û–†–©')" title="Listen on Forvo">üîä</button> (Borshch) ‚Äî The famous beet soup! All the tricky sounds in one word: –ë(B), –û(O), –†(R), –©(Shch)!</li>
<li><strong>–ñ–ï–õ–ï</strong> <button class="audio-btn" onclick="openForvo('–ñ–ï–õ–ï')" title="Listen on Forvo">üîä</button> (Zhele) ‚Äî Jelly.</li>
<li><strong>–ô–û–ì–£–†–¢</strong> <button class="audio-btn" onclick="openForvo('–ô–û–ì–£–†–¢')" title="Listen on Forvo">üîä</button> (Yohurt) ‚Äî Yogurt. (Note the <strong>–ô</strong> for 'y' sound)</li>
<li><strong>–¶–£–ö–û–†</strong> <button class="audio-btn" onclick="openForvo('–¶–£–ö–û–†')" title="Listen on Forvo">üîä</button> (Tsukor) ‚Äî Sugar.</li>
<li><strong>–î–ñ–ê–ó</strong> <button class="audio-btn" onclick="openForvo('–î–ñ–ê–ó')" title="Listen on Forvo">üîä</button> (Dzhaz) ‚Äî Jazz. (Note the digraph <strong>–î–ñ</strong>)</li>
<li><strong>–Ñ–í–†–û–ü–ê</strong> <button class="audio-btn" onclick="openForvo('–Ñ–í–†–û–ü–ê')" title="Listen on Forvo">üîä</button> (Yevropa) ‚Äî Europe.</li>
<li><strong>–£–ö–†–ê–á–ù–ê</strong> <button class="audio-btn" onclick="openForvo('–£–ö–†–ê–á–ù–ê')" title="Listen on Forvo">üîä</button> (Ukrayina) ‚Äî Ukraine. The '–ò' sound followed by the '–á' sound is very distinct.</li>
</ul>
<h2 id="production">production</h2>
<p>You are exploring Kyiv's historic Podil district. Everywhere you look, you see signs and hear conversations filled with the sounds you've just mastered.</p>
<p>You hear someone say: <strong>"–©–æ —Ü–µ?"</strong> (Shcho tse? - What is this?). You understand the <strong>–©</strong> and <strong>–¶</strong>.<br />
You see a sign for <strong>"–¶–£–ö–ï–†–ö–ò"</strong> (Tsukerky - Candies). You easily read the <strong>–¶</strong> and <strong>–ö</strong>.<br />
A friend points to a map: <strong>"–ú–∏ —Ç—É—Ç, –±—ñ–ª—è –ñ–ò–¢–ù–¨–û–ì–û –†–ò–ù–ö–£."</strong> (My tut, bilia Zhytnioho Rynku - We are here, near the Zhytniy Market). You catch the <strong>–ñ</strong>.<br />
You realize you need to ask for directions. You prepare to say: <strong>"–í–ò–ë–ê–ß–¢–ï, –î–ï –¶–ï–ù–¢–†?"</strong> (Vy-bach-te, de tsentr? - Excuse me, where is the center?).</p>
<p>You've moved beyond simple recognition. You're beginning to participate in the Ukrainian soundscape.</p>
<hr />
<hr /></div>
    </div>
  
      
    <div class="card section-summary">
      <h3>üìã Summary</h3>
      <div class="md-content"><p>Congratulations! You have now met all 33 letters of the Ukrainian alphabet.</p>
<ol>
<li><strong>True Friends:</strong> Familiar faces (A, K, M‚Ä¶)</li>
<li><strong>False Friends:</strong> Tricky spies (P=R, C=S‚Ä¶)</li>
<li><strong>Strangers:</strong> New shapes (–ë, –õ, –î‚Ä¶)</li>
<li><strong>Hissers:</strong> The texture of the language (–ñ, –®, –ß, –©)</li>
<li><strong>Y-Vowels:</strong> The melody (–Ø, –Æ, –Ñ, –á)</li>
</ol>
<p>You can now pronounce <strong>–ë–û–†–©</strong> (Borshch) correctly. You can ask <strong>–î–ï –ú–ï–¢–†–û?</strong> (Where is the metro?). In the next module, we will learn how these words change gender. Yes, words have gender. Don't worry, it's logical!</p></div>
    </div>
  
      <div class="btn-group">
        <button class="btn btn-primary" onclick="showSection('activity-0')">Activities ‚Üí</button>
      </div>
    </section>
  
    
    <section id="activity-0" class="section"><div class="card"><h3>The Hissing Sounds</h3>
      <div class="score-display"><span class="score"><span id="activity-0-score">0</span>/12</span></div>
      <div class="match-container" id="activity-0-container"><svg class="match-lines" id="activity-0-lines"></svg>
        <div class="match-column" id="activity-0-left"></div>
        <div class="match-column" id="activity-0-right"></div>
      </div>
      <div class="completion-message" id="activity-0-complete"><h3>Perfect!</h3></div>
      <div class="btn-group"><button class="btn btn-outline" onclick="resetActivity('activity-0')">Reset</button><button class="btn btn-primary" onclick="showSection('activity-1')">Next ‚Üí</button></div>
    </div></section>

    <section id="activity-1" class="section"><div class="card"><h3>The &quot;Y&quot; Vowels</h3>
      <div class="score-display"><span class="score"><span id="activity-1-score">0</span>/12</span></div>
      <div id="activity-1-container"></div>
      <div class="completion-message" id="activity-1-complete"><h3>Complete!</h3></div>
      <div class="btn-group"><button class="btn btn-outline" onclick="resetActivity('activity-1')">Reset</button><button class="btn btn-primary" onclick="showSection('activity-2')">Next ‚Üí</button></div>
    </div></section>

    <section id="activity-2" class="section"><div class="card"><h3>Print vs Italic Form Description</h3>
      <div class="score-display"><span class="score"><span id="activity-2-score">0</span>/12</span></div>
      <div class="match-container" id="activity-2-container"><svg class="match-lines" id="activity-2-lines"></svg>
        <div class="match-column" id="activity-2-left"></div>
        <div class="match-column" id="activity-2-right"></div>
      </div>
      <div class="completion-message" id="activity-2-complete"><h3>Perfect!</h3></div>
      <div class="btn-group"><button class="btn btn-outline" onclick="resetActivity('activity-2')">Reset</button><button class="btn btn-primary" onclick="showSection('activity-3')">Next ‚Üí</button></div>
    </div></section>

    <section id="activity-3" class="section"><div class="card"><h3>Letter Categories</h3>
      <div class="score-display"><span class="score"><span id="activity-3-score">0</span>/16</span></div>
      <div class="sort-pool" id="activity-3-pool"><div class="sort-items" id="activity-3-items"></div></div>
      <div class="sort-groups" id="activity-3-groups"></div>
      <div class="completion-message" id="activity-3-complete"><h3>All Sorted!</h3></div>
      <div class="btn-group"><button class="btn btn-outline" onclick="resetActivity('activity-3')">Reset</button><button class="btn btn-primary" onclick="showSection('activity-4')">Next ‚Üí</button></div>
    </div></section>

    <section id="activity-4" class="section"><div class="card"><h3>Complete the Word</h3>
      <div class="score-display"><span class="score"><span id="activity-4-score">0</span>/12</span></div>
      <div id="activity-4-container" class="fill-container"></div>
      <div class="completion-message" id="activity-4-complete"><h3>Complete!</h3></div>
      <div class="btn-group"><button class="btn btn-outline" onclick="resetActivity('activity-4')">Reset</button><button class="btn btn-primary" onclick="showSection('activity-5')">Next ‚Üí</button></div>
    </div></section>

    <section id="activity-5" class="section"><div class="card"><h3>Survival Phrases</h3>
      <div class="score-display"><span class="score"><span id="activity-5-score">0</span>/12</span></div>
      <div id="activity-5-container" class="order-container"></div>
      <div class="completion-message" id="activity-5-complete"><h3>Perfect Order!</h3></div>
      <div class="btn-group"><button class="btn btn-outline" onclick="resetActivity('activity-5')">Reset</button><button class="btn btn-primary" onclick="showSection('activity-6')">Next ‚Üí</button></div>
    </div></section>

    <section id="activity-6" class="section"><div class="card"><h3>Hard G vs Soft H</h3>
      <div class="score-display"><span class="score"><span id="activity-6-score">0</span>/12</span></div>
      <div id="activity-6-container"></div>
      <div class="completion-message" id="activity-6-complete"><h3>Complete!</h3></div>
      <div class="btn-group"><button class="btn btn-outline" onclick="resetActivity('activity-6')">Reset</button><button class="btn btn-primary" onclick="showSection('activity-7')">Next ‚Üí</button></div>
    </div></section>

    <section id="activity-7" class="section"><div class="card"><h3>Scrambled Letters</h3>
      <div class="score-display"><span class="score"><span id="activity-7-score">0</span>/12</span></div>
      <div id="activity-7-container" class="order-container"></div>
      <div class="completion-message" id="activity-7-complete"><h3>Perfect Order!</h3></div>
      <div class="btn-group"><button class="btn btn-outline" onclick="resetActivity('activity-7')">Reset</button><button class="btn btn-primary" onclick="showSection('activity-8')">Next ‚Üí</button></div>
    </div></section>

    <section id="activity-8" class="section"><div class="card"><h3>Letter Facts</h3>
      <div class="score-display"><span class="score"><span id="activity-8-score">0</span>/12</span></div>
      <div id="activity-8-container"></div>
      <div class="completion-message" id="activity-8-complete"><h3>Complete!</h3></div>
      <div class="btn-group"><button class="btn btn-outline" onclick="resetActivity('activity-8')">Reset</button><button class="btn btn-primary" onclick="showSection('vocab')">Next ‚Üí</button></div>
    </div></section>
    
    <section id="vocab" class="section">
      <div class="card">
        <h3>–°–ª–æ–≤–Ω–∏–∫ (34)</h3>
        <div class="vocab-table-container">
          <table class="vocab-table">
            <thead><tr>
    <th>–°–ª–æ–≤–æ</th>
    <th>–í–∏–º–æ–≤–∞</th>
    <th>IPA</th>
    <th>–ü–µ—Ä–µ–∫–ª–∞–¥</th>
    <th>–ü—Ä–∏–º—ñ—Ç–∫–∞</th>
  </tr></thead>
            <tbody><tr><td class="vocab-uk">–±—É–∫–≤–∞</td><td class="vocab-translit">/Ààbukw…ë/</td><td class="vocab-ipa">letter</td><td class="vocab-en">noun</td><td class="vocab-note"><button class="audio-btn" onclick="openForvo('–±—É–∫–≤–∞')" title="Listen on Forvo">üîä</button></td></tr><tr><td class="vocab-uk">—Å–ª–æ–≤–æ</td><td class="vocab-translit">/Ààsl…îw…î/</td><td class="vocab-ipa">word</td><td class="vocab-en">noun</td><td class="vocab-note"><button class="audio-btn" onclick="openForvo('—Å–ª–æ–≤–æ')" title="Listen on Forvo">üîä</button></td></tr><tr><td class="vocab-uk">–∞–ª—Ñ–∞–≤—ñ—Ç</td><td class="vocab-translit">/…ëlf…ëÀàvit/</td><td class="vocab-ipa">alphabet</td><td class="vocab-en">noun</td><td class="vocab-note"><button class="audio-btn" onclick="openForvo('–∞–ª—Ñ–∞–≤—ñ—Ç')" title="Listen on Forvo">üîä</button></td></tr><tr><td class="vocab-uk">–º–æ–≤–∞</td><td class="vocab-translit">/Ààm…îw…ë/</td><td class="vocab-ipa">language</td><td class="vocab-en">noun</td><td class="vocab-note"><button class="audio-btn" onclick="openForvo('–º–æ–≤–∞')" title="Listen on Forvo">üîä</button></td></tr><tr><td class="vocab-uk">—É–∫—Ä–∞—ó–Ω—Å—å–∫–∞</td><td class="vocab-translit">/ukr…ëÀàjin ≤s ≤k…ë/</td><td class="vocab-ipa">Ukrainian</td><td class="vocab-en">adj</td><td class="vocab-note"><button class="audio-btn" onclick="openForvo('—É–∫—Ä–∞—ó–Ω—Å—å–∫–∞')" title="Listen on Forvo">üîä</button></td></tr><tr><td class="vocab-uk">–∞–Ω–≥–ª—ñ–π—Å—å–∫–∞</td><td class="vocab-translit">/…ënÀà…¶l ≤ijs ≤k…ë/</td><td class="vocab-ipa">English</td><td class="vocab-en">adj</td><td class="vocab-note"><button class="audio-btn" onclick="openForvo('–∞–Ω–≥–ª—ñ–π—Å—å–∫–∞')" title="Listen on Forvo">üîä</button></td></tr><tr><td class="vocab-uk">—Ç–∞–∫</td><td class="vocab-translit">/t…ëk/</td><td class="vocab-ipa">yes</td><td class="vocab-en">part</td><td class="vocab-note"><button class="audio-btn" onclick="openForvo('—Ç–∞–∫')" title="Listen on Forvo">üîä</button></td></tr><tr><td class="vocab-uk">–Ω—ñ</td><td class="vocab-translit">/n ≤i/</td><td class="vocab-ipa">no</td><td class="vocab-en">part</td><td class="vocab-note"><button class="audio-btn" onclick="openForvo('–Ω—ñ')" title="Listen on Forvo">üîä</button></td></tr><tr><td class="vocab-uk">–¥–æ–±—Ä–µ</td><td class="vocab-translit">/Ààd…îbr…õ/</td><td class="vocab-ipa">good/well</td><td class="vocab-en">adv</td><td class="vocab-note"><button class="audio-btn" onclick="openForvo('–¥–æ–±—Ä–µ')" title="Listen on Forvo">üîä</button></td></tr><tr><td class="vocab-uk">–¥—è–∫—É—é</td><td class="vocab-translit">/Ààd ≤…ëkuju/</td><td class="vocab-ipa">thank you</td><td class="vocab-en">verb</td><td class="vocab-note"><button class="audio-btn" onclick="openForvo('–¥—è–∫—É—é')" title="Listen on Forvo">üîä</button></td></tr><tr><td class="vocab-uk">–±—É–¥—å –ª–∞—Å–∫–∞</td><td class="vocab-translit">/bud ≤ Ààl…ësk…ë/</td><td class="vocab-ipa">please</td><td class="vocab-en">phrase</td><td class="vocab-note"><button class="audio-btn" onclick="openForvo('–±—É–¥—å –ª–∞—Å–∫–∞')" title="Listen on Forvo">üîä</button></td></tr><tr><td class="vocab-uk">–ø—Ä–∏–≤—ñ—Ç</td><td class="vocab-translit">/pr…™Ààvit/</td><td class="vocab-ipa">hi</td><td class="vocab-en">interj</td><td class="vocab-note"><button class="audio-btn" onclick="openForvo('–ø—Ä–∏–≤—ñ—Ç')" title="Listen on Forvo">üîä</button></td></tr><tr><td class="vocab-uk">–¥–æ –ø–æ–±–∞—á–µ–Ω–Ω—è</td><td class="vocab-translit">/d…î p…îÀàb…ët Éenn ≤…ë/</td><td class="vocab-ipa">goodbye</td><td class="vocab-en">phrase</td><td class="vocab-note"><button class="audio-btn" onclick="openForvo('–¥–æ –ø–æ–±–∞—á–µ–Ω–Ω—è')" title="Listen on Forvo">üîä</button></td></tr><tr><td class="vocab-uk">–≤–∏–±–∞—á—Ç–µ</td><td class="vocab-translit">/Ààw…™b…ët Éte/</td><td class="vocab-ipa">sorry</td><td class="vocab-en">verb</td><td class="vocab-note"><button class="audio-btn" onclick="openForvo('–≤–∏–±–∞—á—Ç–µ')" title="Listen on Forvo">üîä</button></td></tr><tr><td class="vocab-uk">–ø—Ä–æ—à—É</td><td class="vocab-translit">/Ààpr…î Éu/</td><td class="vocab-ipa">you&#039;re welcome</td><td class="vocab-en">verb</td><td class="vocab-note"><button class="audio-btn" onclick="openForvo('–ø—Ä–æ—à—É')" title="Listen on Forvo">üîä</button></td></tr><tr><td class="vocab-uk">—â–æ</td><td class="vocab-translit">/ Ét É…î/</td><td class="vocab-ipa">what</td><td class="vocab-en">pron</td><td class="vocab-note"><button class="audio-btn" onclick="openForvo('—â–æ')" title="Listen on Forvo">üîä</button></td></tr><tr><td class="vocab-uk">—è–∫</td><td class="vocab-translit">/j…ëk/</td><td class="vocab-ipa">how</td><td class="vocab-en">adv</td><td class="vocab-note"><button class="audio-btn" onclick="openForvo('—è–∫')" title="Listen on Forvo">üîä</button></td></tr><tr><td class="vocab-uk">–¥–µ</td><td class="vocab-translit">/d…õ/</td><td class="vocab-ipa">where</td><td class="vocab-en">adv</td><td class="vocab-note"><button class="audio-btn" onclick="openForvo('–¥–µ')" title="Listen on Forvo">üîä</button></td></tr><tr><td class="vocab-uk">—Ö—Ç–æ</td><td class="vocab-translit">/xt…î/</td><td class="vocab-ipa">who</td><td class="vocab-en">pron</td><td class="vocab-note"><button class="audio-btn" onclick="openForvo('—Ö—Ç–æ')" title="Listen on Forvo">üîä</button></td></tr><tr><td class="vocab-uk">—Ü–µ</td><td class="vocab-translit">/t É…õ/</td><td class="vocab-ipa">this is</td><td class="vocab-en">pron</td><td class="vocab-note"><button class="audio-btn" onclick="openForvo('—Ü–µ')" title="Listen on Forvo">üîä</button></td></tr><tr><td class="vocab-uk">–±–æ—Ä—â</td><td class="vocab-translit">/b…îr Ét É/</td><td class="vocab-ipa">borsch</td><td class="vocab-en">noun</td><td class="vocab-note"><button class="audio-btn" onclick="openForvo('–±–æ—Ä—â')" title="Listen on Forvo">üîä</button></td></tr><tr><td class="vocab-uk">–π–æ–≥—É—Ä—Ç</td><td class="vocab-translit">/Ààj…î…¶urt/</td><td class="vocab-ipa">yogurt</td><td class="vocab-en">noun</td><td class="vocab-note"><button class="audio-btn" onclick="openForvo('–π–æ–≥—É—Ä—Ç')" title="Listen on Forvo">üîä</button></td></tr><tr><td class="vocab-uk">–∂–µ–ª–µ</td><td class="vocab-translit">/ í…õÀàl…õ/</td><td class="vocab-ipa">jelly</td><td class="vocab-en">noun</td><td class="vocab-note"><button class="audio-btn" onclick="openForvo('–∂–µ–ª–µ')" title="Listen on Forvo">üîä</button></td></tr><tr><td class="vocab-uk">–º–∞–π–æ–Ω–µ–∑</td><td class="vocab-translit">/m…ëj…îÀàn…õz/</td><td class="vocab-ipa">mayonnaise</td><td class="vocab-en">noun</td><td class="vocab-note"><button class="audio-btn" onclick="openForvo('–º–∞–π–æ–Ω–µ–∑')" title="Listen on Forvo">üîä</button></td></tr><tr><td class="vocab-uk">—à–æ–∫–æ–ª–∞–¥</td><td class="vocab-translit">/ É…îk…îÀàl…ëd/</td><td class="vocab-ipa">chocolate</td><td class="vocab-en">noun</td><td class="vocab-note"><button class="audio-btn" onclick="openForvo('—à–æ–∫–æ–ª–∞–¥')" title="Listen on Forvo">üîä</button></td></tr><tr><td class="vocab-uk">—á–µ–º–ø—ñ–æ–Ω</td><td class="vocab-translit">/t É…õmpiÀà…în/</td><td class="vocab-ipa">champion</td><td class="vocab-en">noun</td><td class="vocab-note"><button class="audio-btn" onclick="openForvo('—á–µ–º–ø—ñ–æ–Ω')" title="Listen on Forvo">üîä</button></td></tr><tr><td class="vocab-uk">—Ü–µ–Ω—Ç—Ä</td><td class="vocab-translit">/t É…õntr/</td><td class="vocab-ipa">center</td><td class="vocab-en">noun</td><td class="vocab-note"><button class="audio-btn" onclick="openForvo('—Ü–µ–Ω—Ç—Ä')" title="Listen on Forvo">üîä</button></td></tr><tr><td class="vocab-uk">—Ü—É–∫–æ—Ä</td><td class="vocab-translit">/Ààtsuk…îr/</td><td class="vocab-ipa">sugar</td><td class="vocab-en">noun</td><td class="vocab-note"><button class="audio-btn" onclick="openForvo('—Ü—É–∫–æ—Ä')" title="Listen on Forvo">üîä</button></td></tr><tr><td class="vocab-uk">–¥–∂–∏–Ω—Å–∏</td><td class="vocab-translit">/Ààd í…™ns…™/</td><td class="vocab-ipa">jeans</td><td class="vocab-en">noun</td><td class="vocab-note"><button class="audio-btn" onclick="openForvo('–¥–∂–∏–Ω—Å–∏')" title="Listen on Forvo">üîä</button></td></tr><tr><td class="vocab-uk">–¥–∂–∞–∑</td><td class="vocab-translit">/d í…ëz/</td><td class="vocab-ipa">jazz</td><td class="vocab-en">noun</td><td class="vocab-note"><button class="audio-btn" onclick="openForvo('–¥–∂–∞–∑')" title="Listen on Forvo">üîä</button></td></tr><tr><td class="vocab-uk">–Ñ–≤—Ä–æ–ø–∞</td><td class="vocab-translit">/j…õwÀàr…îp…ë/</td><td class="vocab-ipa">Europe</td><td class="vocab-en">noun</td><td class="vocab-note"><button class="audio-btn" onclick="openForvo('–Ñ–≤—Ä–æ–ø–∞')" title="Listen on Forvo">üîä</button></td></tr><tr><td class="vocab-uk">–£–∫—Ä–∞—ó–Ω–∞</td><td class="vocab-translit">/ukr…ëÀàjin…ë/</td><td class="vocab-ipa">Ukraine</td><td class="vocab-en">noun</td><td class="vocab-note"><button class="audio-btn" onclick="openForvo('–£–∫—Ä–∞—ó–Ω–∞')" title="Listen on Forvo">üîä</button></td></tr><tr><td class="vocab-uk">–õ–æ–Ω–¥–æ–Ω</td><td class="vocab-translit">/Ààl…înd…în/</td><td class="vocab-ipa">London</td><td class="vocab-en">noun</td><td class="vocab-note"><button class="audio-btn" onclick="openForvo('–õ–æ–Ω–¥–æ–Ω')" title="Listen on Forvo">üîä</button></td></tr><tr><td class="vocab-uk">–ö–∏—ó–≤</td><td class="vocab-translit">/Ààk…™jiuÃØ/</td><td class="vocab-ipa">Kyiv</td><td class="vocab-en">noun</td><td class="vocab-note"><button class="audio-btn" onclick="openForvo('–ö–∏—ó–≤')" title="Listen on Forvo">üîä</button></td></tr></tbody>
          </table>
        </div>
      </div>
      
      <div class="btn-group">
        <button class="btn btn-primary" onclick="showSection('lesson')">‚Üê Back to Lesson</button>
      </div>
    </section>
  </main><footer>Module 02 ¬∑ curricula-opus</footer>
  <script>

    const activitiesData = [{"id":"activity-0","type":"match-up","title":"The Hissing Sounds","data":{"type":"match-up","pairs":[{"left":"–ñ","right":"\"S\" in Pleasure (Zh)"},{"left":"–®","right":"\"Sh\" in She"},{"left":"–ß","right":"\"Ch\" in Chair"},{"left":"–©","right":"\"Sh\" + \"Ch\" (Fresh cheese)"},{"left":"–¶","right":"\"Ts\" in Cats"},{"left":"–î–ñ","right":"\"J\" in Jam"},{"left":"–î–ó","right":"\"Ds\" in Pods"},{"left":"–ô","right":"\"Y\" in Boy (short i)"},{"left":"–ì","right":"\"H\" in Home (soft, breathy)"},{"left":"“ê","right":"\"G\" in Go (hard, explosive)"},{"left":"–¨","right":"Softens previous letter"},{"left":"–ò","right":"\"I\" in Sit (hard, guttural)"}],"shuffleRight":true}},{"id":"activity-1","type":"quiz","title":"The \"Y\" Vowels","data":{"type":"quiz","questions":[{"question":"What sound is –Ø?","options":["Ya (Yard)","Yu (You)","Ye (Yes)","Yo (Yonder)"],"correctIndex":0,"explanation":""},{"question":"What sound is –Æ?","options":["Yu (You)","Ya (Yard)","Yi (Yield)","Ye (Yes)"],"correctIndex":0,"explanation":""},{"question":"What sound is –Ñ?","options":["Ye (Yes)","E (Eh)","Ya (Yard)","Yo (Yonder)"],"correctIndex":0,"explanation":""},{"question":"What sound is –á?","options":["Yi (Yield - two dots, two sounds)","I (Machine)","Y (Yard)","J (Jump)"],"correctIndex":0,"explanation":""},{"question":"What sound is –ô?","options":["Y (Short I as in Boy)","J (Jump)","Ch (Chew)","Sh (Shoe)"],"correctIndex":0,"explanation":""},{"question":"What sound is –Æ in \"–ú–ï–ù–Æ\" (Menu)?","options":["U (similar to 'u' in 'menu')","A (Mena)","I (Meni)","O (Meno)"],"correctIndex":0,"explanation":""},{"question":"What sound is –Ø in \"–Ü–¢–ê–õ–Ü–Ø\" (Italy)?","options":["Ya (Italia)","Yu (Italiu)","Yi (Italii)","Ye (Italie)"],"correctIndex":0,"explanation":""},{"question":"What sound is –Ñ in \"–Ñ–í–†–û–ü–ê\" (Europe)?","options":["Ye (Yevropa)","E (Evropa)","Ya (Yavropa)","Yu (Yuvropa)"],"correctIndex":0,"explanation":""},{"question":"What sound is –á in \"–ö–ò–á–í\" (Kyiv)?","options":["Yi (Kyiv)","I (Kyiv)","Y (Kyyv)","Ye (Kyev)"],"correctIndex":0,"explanation":""},{"question":"Which letter makes the \"Zh\" sound (pleasure)?","options":["–ñ","–®","–©","–ß"],"correctIndex":0,"explanation":""},{"question":"Which letter makes the \"Sh\" sound (shoe)?","options":["–®","–ñ","–©","–ß"],"correctIndex":0,"explanation":""},{"question":"Which letter makes the \"Ch\" sound (chair)?","options":["–ß","–¶","–®","–©"],"correctIndex":0,"explanation":""}],"shuffleQuestions":true,"shuffleOptions":true,"showCorrectAnswers":true}},{"id":"activity-2","type":"match-up","title":"Print vs Italic Form Description","data":{"type":"match-up","pairs":[{"left":"—Ç (print)","right":"often looks like English 'm'"},{"left":"–ø (print)","right":"often looks like English 'n'"},{"left":"–¥ (print)","right":"often looks like English 'g'"},{"left":"–∏ (print)","right":"often looks like English 'u'"},{"left":"–≥ (print)","right":"often looks like a backward 's' (‚àÇ)"},{"left":"–ª (print)","right":"often looks like an inverted v or hook"},{"left":"—à (print)","right":"often looks like a 'w'"},{"left":"–º (print)","right":"often looks like an 'M'"},{"left":"–∞ (print)","right":"often looks like an 'a'"},{"left":"–≤ (print)","right":"often looks like a 'b'"},{"left":"–∑ (print)","right":"often looks like a 'z'"},{"left":"–∫ (print)","right":"often looks like a 'k'"}],"shuffleRight":true}},{"id":"activity-3","type":"group-sort","title":"Letter Categories","data":{"type":"group-sort","groups":[{"id":"hissers","name":"Hissers","items":["–ñ","–®","–ß","–©","–¶","–î–ñ","–î–ó"],"nameUk":"Sibilants & Affricates"},{"id":"iotated","name":"Iotated","items":["–Ø","–Æ","–Ñ","–á"],"nameUk":"Y-vowels"},{"id":"unique-consonants--modifiers","name":"Unique Consonants & Modifiers","items":["–ì","“ê","–ô","–¨ (Soft Sign)","–ò (Hard I)"]}],"shuffleItems":true}},{"id":"activity-4","type":"fill-blank","title":"Complete the Word","data":{"type":"fill-blank","items":[{"prompt":"_ –Ø –ö –£ –Æ (Thank you)\n   - [!answer] –î\n   - [!options] –î | –¢ | –ó | –°","answer":""},{"prompt":"–ü –† –ò –í _ –¢ (Hi)\n   - [!answer] –Ü\n   - [!options] –Ü | –ò | –á | –ï","answer":""},{"prompt":"–ë _ –î –¨  –õ –ê –° –ö –ê (Please)\n   - [!answer] –£\n   - [!options] –£ | –Æ | –û | –ê","answer":""},{"prompt":"–ë –û –† _ (Beet soup)\n   - [!answer] –©\n   - [!options] –© | –® | –ß | –ñ","answer":""},{"prompt":"_ –û  –ü –û –ë –ê –ß –ï –ù –ù –Ø (Goodbye)\n   - [!answer] –î\n   - [!options] –î | –¢ | –ü | –ì","answer":""},{"prompt":"–® –û –ö –û –õ –ê _ (Sweet treat - Chocolate)\n   - [!answer] –î\n   - [!options] –î | –¢ | –ü | –ë","answer":""},{"prompt":"–î –ñ _ –ó (Music genre - Jazz)\n   - [!answer] –ê\n   - [!options] –ê | –ï | –Ü | –£","answer":""},{"prompt":"–ß –ï –ú –ü –Ü –û _ (Winner - Champion)\n   - [!answer] –ù\n   - [!options] –ù | –ü | –ú | –õ","answer":""},{"prompt":"–õ –û –ù –î –û _ (City - London)\n   - [!answer] –ù\n   - [!options] –ù | –ü | –ú | –õ","answer":""},{"prompt":"–¶ –£ –ö –û _ (Sweetener - Sugar)\n    - [!answer] –†\n    - [!options] –† | –ü | –õ | –ù","answer":""},{"prompt":"–î –ñ –ò –ù –° _ (Clothing - Jeans)\n    - [!answer] –ò\n    - [!options] –ò | –Ü | –á | –ï","answer":""},{"prompt":"–ô –û –ì –£ –† _ (Dairy food - Yogurt)\n    - [!answer] –¢\n    - [!options] –¢ | –î | –ü | –ë","answer":""}]}},{"id":"activity-5","type":"unjumble","title":"Survival Phrases","data":{"type":"unjumble","isUnjumble":true,"items":[{"words":["–¢","–ê","–ö"],"answer":"–¢–ê–ö","translation":"Yes"},{"words":["–Ü","–ù"],"answer":"–ù–Ü","translation":"No"},{"words":["–û","–©"],"answer":"–©–û","translation":"What"},{"words":["–ï","–î"],"answer":"–î–ï","translation":"Where"},{"words":["–û","–•","–¢"],"answer":"–•–¢–û","translation":"Who"},{"words":["–ö","–Ø"],"answer":"–Ø–ö","translation":"How"},{"words":["–ï","–¶"],"answer":"–¶–ï","translation":"This is"},{"words":["–ë","–†","–ï","–î","–û"],"answer":"–î–û–ë–†–ï","translation":"Good"},{"words":["–¢","–ú","–ï","–û","–†"],"answer":"–ú–ï–¢–†–û","translation":"Metro"},{"words":["–ö","–ê","–í","–ë","–£"],"answer":"–ë–£–ö–í–ê","translation":"Letter"},{"words":["–û","–í","–õ","–û","–°"],"answer":"–°–õ–û–í–û","translation":"Word"},{"words":["–í","–û","–ê","–ú"],"answer":"–ú–û–í–ê","translation":"Language"}]}},{"id":"activity-6","type":"quiz","title":"Hard G vs Soft H","data":{"type":"quiz","questions":[{"question":"For the soft, breathy 'H' sound (like in \"Home\").","options":["–ì","“ê"],"correctIndex":0,"explanation":""},{"question":"For the hard, explosive 'G' sound (like in \"Go\").","options":["“ê","–ì"],"correctIndex":0,"explanation":""},{"question":"For the initial sound in \"Hostomel'\" (city).","options":["–ì","“ê"],"correctIndex":0,"explanation":""},{"question":"For the initial sound in \"Gudzyk\" (button).","options":["“ê","–ì"],"correctIndex":0,"explanation":""},{"question":"For the soft 'H' in \"Holova\" (head).","options":["–ì","“ê"],"correctIndex":0,"explanation":""},{"question":"For the hard 'G' in \"Gava\" (crow).","options":["“ê","–ì"],"correctIndex":0,"explanation":""},{"question":"For the initial sound in \"Hulia\" (to walk).","options":["–ì","“ê"],"correctIndex":0,"explanation":""},{"question":"For the initial sound in \"Geografiya\" (geography).","options":["–ì","“ê"],"correctIndex":0,"explanation":""},{"question":"For the initial sound in \"Gramatyka\" (grammar).","options":["–ì","“ê"],"correctIndex":0,"explanation":""},{"question":"For the hard 'G' in \"Garderob\" (wardrobe).","options":["“ê","–ì"],"correctIndex":0,"explanation":""},{"question":"For the soft 'H' in \"Humor\".","options":["–ì","“ê"],"correctIndex":0,"explanation":""},{"question":"For the soft 'H' in \"Hero\".","options":["–ì","“ê"],"correctIndex":0,"explanation":""}],"shuffleQuestions":true,"shuffleOptions":true,"showCorrectAnswers":true}},{"id":"activity-7","type":"anagram","title":"Scrambled Letters","data":{"type":"anagram","isAnagram":true,"items":[{"letters":["—É","–±","–∫","–∞","–≤"],"answer":"–ë–£–ö–í–ê (wait - bukva)","translation":"Letter"},{"letters":["–≤","–æ","–ª","–æ","—Å"],"answer":"—Å–ª–æ–≤–æ","translation":"Word"},{"letters":["–¥","–æ","–Ω","–õ","–æ","–Ω"],"answer":"–õ–æ–Ω–¥–æ–Ω","translation":"City"},{"letters":["–≤","–∞","–ö","–∏","—ó"],"answer":"–ö–∏—ó–≤","translation":"City"},{"letters":["–∫","–∞","–¢"],"answer":"–¢–∞–∫","translation":"Yes"},{"letters":["—ñ","–ù"],"answer":"–ù—ñ","translation":"No"},{"letters":["–∞","—Ä","–∫","–û","—É","—Ü"],"answer":"–¶—É–∫–æ—Ä","translation":"Sugar"},{"letters":["—â","–æ","–ë","—Ä"],"answer":"–ë–æ—Ä—â","translation":"Soup"},{"letters":["–∑","–∞","–î","–∂"],"answer":"–î–∂–∞–∑","translation":"Music"},{"letters":["–æ","–ª","–®","–æ","–∫","–¥","–∞"],"answer":"–®–æ–∫–æ–ª–∞–¥","translation":"Sweet"},{"letters":["–ø","–∞","–Ñ","–≤","—Ä","–æ"],"answer":"–Ñ–≤—Ä–æ–ø–∞","translation":"Continent"},{"letters":["—é","–∫","—É","—è","–î"],"answer":"–î—è–∫—É—é","translation":"Thank you"}]}},{"id":"activity-8","type":"true-false","title":"Letter Facts","data":{"type":"true-false","statements":[{"statement":"The letter –© makes a two-part \"sh-ch\" sound.","isTrue":true,"explanation":"Correct! Like in \"fresh cheese\"."},{"statement":"The letter –¶ makes a \"ch\" sound.","isTrue":false,"explanation":"Incorrect. –¶ makes a \"ts\" sound."},{"statement":"The letter –¨ (Soft Sign) has no sound of its own.","isTrue":true,"explanation":"Correct! It only softens the preceding consonant."},{"statement":"The letter –ò sounds like \"ee\" in machine.","isTrue":false,"explanation":"Incorrect. –ò sounds like \"i\" in sit. –Ü sounds like \"ee\"."},{"statement":"The letter –á always has a built-in \"y\" sound.","isTrue":true,"explanation":"Correct! It's \"Yee\"."},{"statement":"The letter –Æ makes a \"ya\" sound.","isTrue":false,"explanation":"Incorrect. –Æ makes a \"yu\" sound. –Ø makes a \"ya\" sound."},{"statement":"The letter –Ñ makes a \"ye\" sound.","isTrue":true,"explanation":"Correct!"},{"statement":"The letter –ñ makes a \"sh\" sound.","isTrue":false,"explanation":"Incorrect. –ñ makes a \"zh\" sound (like 's' in pleasure). –® makes a \"sh\" sound."},{"statement":"The letters –î–ñ form a single \"j\" sound.","isTrue":true,"explanation":"Correct! Like in \"jam\"."},{"statement":"The letters –î–ó form a \"d-z\" sound as two separate sounds.","isTrue":false,"explanation":"Incorrect. They form a single \"dz\" sound, like 'ds' in 'pods'."},{"statement":"The letter –ô is a consonant.","isTrue":true,"explanation":"Correct! It's a short 'y' sound."},{"statement":"The italic form of —Ç looks like a 'u'.","isTrue":false,"explanation":"Incorrect. The italic form of —Ç looks like an 'm'. The italic form of –∏ looks like a 'u'."}]}}];
    const vocabData = [{"uk":"–±—É–∫–≤–∞","translit":"/Ààbukw…ë/","en":"noun","note":"[üîä](audio_bukva)"},{"uk":"—Å–ª–æ–≤–æ","translit":"/Ààsl…îw…î/","en":"noun","note":"[üîä](audio_slovo)"},{"uk":"–∞–ª—Ñ–∞–≤—ñ—Ç","translit":"/…ëlf…ëÀàvit/","en":"noun","note":"[üîä](audio_alfavit)"},{"uk":"–º–æ–≤–∞","translit":"/Ààm…îw…ë/","en":"noun","note":"[üîä](audio_mova)"},{"uk":"—É–∫—Ä–∞—ó–Ω—Å—å–∫–∞","translit":"/ukr…ëÀàjin ≤s ≤k…ë/","en":"adj","note":"[üîä](audio_ukrainska)"},{"uk":"–∞–Ω–≥–ª—ñ–π—Å—å–∫–∞","translit":"/…ënÀà…¶l ≤ijs ≤k…ë/","en":"adj","note":"[üîä](audio_anhliyska)"},{"uk":"—Ç–∞–∫","translit":"/t…ëk/","en":"part","note":"[üîä](audio_tak)"},{"uk":"–Ω—ñ","translit":"/n ≤i/","en":"part","note":"[üîä](audio_ni)"},{"uk":"–¥–æ–±—Ä–µ","translit":"/Ààd…îbr…õ/","en":"adv","note":"[üîä](audio_dobre)"},{"uk":"–¥—è–∫—É—é","translit":"/Ààd ≤…ëkuju/","en":"verb","note":"[üîä](audio_dyakuyu)"},{"uk":"–±—É–¥—å –ª–∞—Å–∫–∞","translit":"/bud ≤ Ààl…ësk…ë/","en":"phrase","note":"[üîä](audio_budlaska)"},{"uk":"–ø—Ä–∏–≤—ñ—Ç","translit":"/pr…™Ààvit/","en":"interj","note":"[üîä](audio_pryvit)"},{"uk":"–¥–æ –ø–æ–±–∞—á–µ–Ω–Ω—è","translit":"/d…î p…îÀàb…ët Éenn ≤…ë/","en":"phrase","note":"[üîä](audio_dopobachennya)"},{"uk":"–≤–∏–±–∞—á—Ç–µ","translit":"/Ààw…™b…ët Éte/","en":"verb","note":"[üîä](audio_vybachte)"},{"uk":"–ø—Ä–æ—à—É","translit":"/Ààpr…î Éu/","en":"verb","note":"[üîä](audio_proshu)"},{"uk":"—â–æ","translit":"/ Ét É…î/","en":"pron","note":"[üîä](audio_shcho)"},{"uk":"—è–∫","translit":"/j…ëk/","en":"adv","note":"[üîä](audio_yak)"},{"uk":"–¥–µ","translit":"/d…õ/","en":"adv","note":"[üîä](audio_de)"},{"uk":"—Ö—Ç–æ","translit":"/xt…î/","en":"pron","note":"[üîä](audio_khto)"},{"uk":"—Ü–µ","translit":"/t É…õ/","en":"pron","note":"[üîä](audio_tse)"},{"uk":"–±–æ—Ä—â","translit":"/b…îr Ét É/","en":"noun","note":"[üîä](audio_borshch)"},{"uk":"–π–æ–≥—É—Ä—Ç","translit":"/Ààj…î…¶urt/","en":"noun","note":"[üîä](audio_yohurt)"},{"uk":"–∂–µ–ª–µ","translit":"/ í…õÀàl…õ/","en":"noun","note":"[üîä](audio_zhele)"},{"uk":"–º–∞–π–æ–Ω–µ–∑","translit":"/m…ëj…îÀàn…õz/","en":"noun","note":"[üîä](audio_mayonez)"},{"uk":"—à–æ–∫–æ–ª–∞–¥","translit":"/ É…îk…îÀàl…ëd/","en":"noun","note":"[üîä](audio_shokolad)"},{"uk":"—á–µ–º–ø—ñ–æ–Ω","translit":"/t É…õmpiÀà…în/","en":"noun","note":"[üîä](audio_chempion)"},{"uk":"—Ü–µ–Ω—Ç—Ä","translit":"/t É…õntr/","en":"noun","note":"[üîä](audio_tsentr)"},{"uk":"—Ü—É–∫–æ—Ä","translit":"/Ààtsuk…îr/","en":"noun","note":"[üîä](audio_tsukor)"},{"uk":"–¥–∂–∏–Ω—Å–∏","translit":"/Ààd í…™ns…™/","en":"noun","note":"[üîä](audio_dzhynsy)"},{"uk":"–¥–∂–∞–∑","translit":"/d í…ëz/","en":"noun","note":"[üîä](audio_dzhaz)"},{"uk":"–Ñ–≤—Ä–æ–ø–∞","translit":"/j…õwÀàr…îp…ë/","en":"noun","note":"[üîä](audio_yevropa)"},{"uk":"–£–∫—Ä–∞—ó–Ω–∞","translit":"/ukr…ëÀàjin…ë/","en":"noun","note":"[üîä](audio_ukraina)"},{"uk":"–õ–æ–Ω–¥–æ–Ω","translit":"/Ààl…înd…în/","en":"noun","note":"[üîä](audio_london)"},{"uk":"–ö–∏—ó–≤","translit":"/Ààk…™jiuÃØ/","en":"noun","note":"[üîä](audio_kyiv)"}];
  
// Answer callout toggle (for new > [!answer] syntax)
function toggleAnswer(id, btn) {
  const el = document.getElementById(id);
  if (!el) return;
  const isUkrainian = document.querySelector('.level-badge')?.textContent.match(/B[12]|C[12]/);
  const showText = isUkrainian ? '–ü–æ–∫–∞–∑–∞—Ç–∏ –≤—ñ–¥–ø–æ–≤—ñ–¥—å' : 'Show Answer';
  const hideText = isUkrainian ? '–°—Ö–æ–≤–∞—Ç–∏ –≤—ñ–¥–ø–æ–≤—ñ–¥—å' : 'Hide Answer';
  const show = !el.classList.contains('show');
  if (show) {
    el.classList.add('show');
    btn.textContent = hideText;
    btn.classList.add('revealed');
  } else {
    el.classList.remove('show');
    btn.textContent = showText;
    btn.classList.remove('revealed');
  }
}

// Section navigation
function showSection(id) {
  document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
  document.querySelectorAll('.nav-tab').forEach(t => t.classList.remove('active'));
  document.getElementById(id)?.classList.add('active');
  document.querySelector('[data-section="' + id + '"]')?.classList.add('active');
}
document.querySelectorAll('.nav-tab').forEach(t => t.addEventListener('click', () => showSection(t.dataset.section)));

// Activity reset dispatcher
function resetActivity(sectionId) {
  const activity = activitiesData.find(a => a.id === sectionId);
  if (!activity) return;

  switch (activity.type) {
    case 'match-up':
      resetMatch(sectionId);
      break;
    case 'quiz':
      resetQuiz(sectionId);
      break;
    case 'true-false':
      resetTf(sectionId);
      break;
    case 'group-sort':
      resetSort(sectionId);
      break;
    case 'fill-blank':
    case 'gap-fill':
      resetFill(sectionId);
      break;
    case 'unjumble':
    case 'anagram':
      resetOrder(sectionId);
      break;
    case 'select':
      resetSelect(sectionId);
      break;
  }
}




// Forvo Integration (Community Native Audio)
// Opens a specific word page on Forvo in a popup window.
function openForvo(text) {
  if (!text) return;

  // URL Encode the text (handles Cyrillic)
  const encodedText = encodeURIComponent(text);
  // Use Search URL with language filter 'uk' to avoid Russian results
  const url = `https://forvo.com/search/${encodedText}/uk/`;

  // Open popup
  const width = 800;
  const height = 600;
  const left = (window.innerWidth - width) / 2;
  const top = (window.innerHeight - height) / 2;

  window.open(
    url,
    'forvo_window',
    `width=${width},height=${height},top=${top},left=${left},resizable=yes,scrollbars=yes`
  );
}

// Initialize all activities from activitiesData array
document.addEventListener('DOMContentLoaded', () => {
  if (typeof activitiesData === 'undefined') return;

  activitiesData.forEach(activity => {
    switch (activity.type) {
      case 'match-up':
        initMatch(activity.id, activity.data);
        break;
      case 'quiz':
        initQuiz(activity.id, activity.data);
        break;
      case 'true-false':
        initTf(activity.id, activity.data);
        break;
      case 'group-sort':
        initSort(activity.id, activity.data);
        break;
      case 'fill-blank':
      case 'gap-fill':
        initFill(activity.id, activity.data);
        break;
      case 'unjumble':
      case 'anagram':
        initOrder(activity.id, activity.data);
        break;
      case 'select':
        initSelect(activity.id, activity.data);
        break;
    }
  });

  // Initialize vocabulary
  if (typeof initVocab === 'function') initVocab();
});


// Quiz Activity - supports multiple instances
const quizState = {};

function initQuiz(sectionId, data) {
  const c = document.getElementById(sectionId + '-container');
  if (!c || !data.questions || !data.questions.length) return;

  quizState[sectionId] = { score: 0, answered: 0, total: data.questions.length, data: data };

  c.innerHTML = '';
  data.questions.forEach((q, i) => {
    const sh = [...q.options].sort(() => Math.random() - 0.5);
    const cor = sh.indexOf(q.options[q.correctIndex]);
    const div = document.createElement('div');
    div.className = 'quiz-question';
    div.dataset.section = sectionId;
    div.innerHTML = '<h4>Q' + (i + 1) + ': ' + q.question + '</h4><div class="quiz-options">' + sh.map((o, j) => '<div class="quiz-option" data-c="' + (j === cor) + '" data-q="' + i + '" data-section="' + sectionId + '">' + o + '</div>').join('') + '</div><div class="quiz-explanation" id="' + sectionId + '-exp-' + i + '">' + (q.explanation || '') + '</div>';
    c.appendChild(div);
  });
  c.querySelectorAll('.quiz-option').forEach(o => o.addEventListener('click', handleQuiz));
}

function handleQuiz(e) {
  const opt = e.target, q = opt.closest('.quiz-question');
  const sectionId = opt.dataset.section;
  if (q.classList.contains('answered')) return;
  q.classList.add('answered');

  const state = quizState[sectionId];
  if (opt.dataset.c === 'true') {
    opt.classList.add('correct');
    state.score++;
  } else {
    opt.classList.add('wrong');
    q.querySelector('[data-c="true"]').classList.add('correct');
  }
  document.getElementById(sectionId + '-exp-' + opt.dataset.q)?.classList.add('show');
  document.getElementById(sectionId + '-score').textContent = state.score;
  state.answered++;
  if (state.answered === state.total) document.getElementById(sectionId + '-complete').classList.add('show');
}

function resetQuiz(sectionId) {
  const state = quizState[sectionId];
  if (!state) return;
  document.getElementById(sectionId + '-score').textContent = '0';
  document.getElementById(sectionId + '-complete')?.classList.remove('show');
  initQuiz(sectionId, state.data);
}


// True/False Activity - supports multiple instances
const tfState = {};

function initTf(sectionId, data) {
  const c = document.getElementById(sectionId + '-container');
  if (!c || !data.statements || !data.statements.length) return;

  tfState[sectionId] = { score: 0, answered: 0, total: data.statements.length, data: data };

  c.innerHTML = '';
  data.statements.forEach((s, i) => {
    const div = document.createElement('div');
    div.className = 'tf-statement';
    div.dataset.section = sectionId;
    div.innerHTML = '<p class="tf-text">' + s.statement + '</p>' +
      '<div class="tf-buttons">' +
      '<button class="tf-btn" data-value="true" data-idx="' + i + '" data-section="' + sectionId + '">True</button>' +
      '<button class="tf-btn" data-value="false" data-idx="' + i + '" data-section="' + sectionId + '">False</button>' +
      '</div>' +
      '<div class="tf-explanation" id="' + sectionId + '-exp-' + i + '">' + (s.explanation || '') + '</div>';
    div.dataset.correct = s.isTrue;
    c.appendChild(div);
  });
  c.querySelectorAll('.tf-btn').forEach(b => b.addEventListener('click', handleTf));
}

function handleTf(e) {
  const btn = e.target;
  const sectionId = btn.dataset.section;
  const idx = parseInt(btn.dataset.idx);
  const statement = btn.closest('.tf-statement');
  const state = tfState[sectionId];
  if (statement.classList.contains('answered')) return;

  statement.classList.add('answered');
  const correct = state.data.statements[idx].isTrue;
  const clicked = btn.dataset.value === 'true';

  if (clicked === correct) {
    btn.classList.add('correct');
    state.score++;
  } else {
    btn.classList.add('wrong');
    // Highlight the correct answer
    statement.querySelector('[data-value="' + correct + '"]').classList.add('correct');
  }

  const exp = document.getElementById(sectionId + '-exp-' + idx);
  if (exp && exp.textContent) exp.classList.add('show');

  document.getElementById(sectionId + '-score').textContent = state.score;
  state.answered++;
  if (state.answered === state.total) document.getElementById(sectionId + '-complete').classList.add('show');
}

function resetTf(sectionId) {
  const state = tfState[sectionId];
  if (!state) return;
  document.getElementById(sectionId + '-score').textContent = '0';
  document.getElementById(sectionId + '-complete')?.classList.remove('show');
  initTf(sectionId, state.data);
}


// Match Activity - supports multiple instances
const matchState = {};

function initMatch(sectionId, data) {
  const container = document.getElementById(sectionId + '-container');
  const leftCol = document.getElementById(sectionId + '-left');
  const rightCol = document.getElementById(sectionId + '-right');
  if (!container || !leftCol || !rightCol || !data.pairs || !data.pairs.length) return;

  const pairs = data.pairs;
  matchState[sectionId] = { selected: null, score: 0, matched: [], total: pairs.length, data: data };

  // Create left column items
  const shuffledLeft = pairs.map((p, i) => ({ text: p.left, idx: i })).sort(() => Math.random() - 0.5);
  leftCol.innerHTML = shuffledLeft.map(p => '<div class="match-item" data-pair="' + p.idx + '" data-section="' + sectionId + '" data-side="left">' + p.text + '</div>').join('');

  // Create right column items
  const shuffledRight = pairs.map((p, i) => ({ text: p.right, idx: i })).sort(() => Math.random() - 0.5);
  rightCol.innerHTML = shuffledRight.map(p => '<div class="match-item" data-pair="' + p.idx + '" data-section="' + sectionId + '" data-side="right">' + p.text + '</div>').join('');

  // Attach click handlers
  leftCol.querySelectorAll('.match-item').forEach(item => {
    item.addEventListener('click', () => handleMatchLeft(item));
  });
  rightCol.querySelectorAll('.match-item').forEach(item => {
    item.addEventListener('click', () => handleMatchRight(item));
  });
}

function handleMatchLeft(item) {
  const sectionId = item.dataset.section;
  const state = matchState[sectionId];
  if (item.classList.contains('matched')) return;

  const leftCol = document.getElementById(sectionId + '-left');
  leftCol.querySelectorAll('.match-item').forEach(i => i.classList.remove('selected'));
  item.classList.add('selected');
  state.selected = { el: item, pair: item.dataset.pair };
}

function handleMatchRight(item) {
  const sectionId = item.dataset.section;
  const state = matchState[sectionId];
  if (item.classList.contains('matched') || !state.selected) return;

  if (state.selected.pair === item.dataset.pair) {
    state.selected.el.classList.remove('selected');
    state.selected.el.classList.add('matched');
    item.classList.add('matched');
    state.matched.push({ left: state.selected.el, right: item });
    state.score++;
    document.getElementById(sectionId + '-score').textContent = state.score;
    drawMatchLines(sectionId);
    if (state.score === state.total) document.getElementById(sectionId + '-complete').classList.add('show');
  } else {
    item.classList.add('wrong');
    setTimeout(() => item.classList.remove('wrong'), 300);
  }
  state.selected = null;
}

function drawMatchLines(sectionId) {
  const svg = document.getElementById(sectionId + '-lines');
  const container = document.getElementById(sectionId + '-container');
  const state = matchState[sectionId];
  if (!svg || !container || !state) return;

  const r = container.getBoundingClientRect();
  svg.innerHTML = '';
  svg.setAttribute('viewBox', '0 0 ' + r.width + ' ' + r.height);
  state.matched.forEach(p => {
    const lr = p.left.getBoundingClientRect(), rr = p.right.getBoundingClientRect();
    const line = document.createElementNS('http://www.w3.org/2000/svg', 'line');
    line.setAttribute('x1', lr.right - r.left);
    line.setAttribute('y1', lr.top + lr.height / 2 - r.top);
    line.setAttribute('x2', rr.left - r.left);
    line.setAttribute('y2', rr.top + rr.height / 2 - r.top);
    line.setAttribute('stroke', '#26a269');
    line.setAttribute('stroke-width', '2');
    svg.appendChild(line);
  });
}

function resetMatch(sectionId) {
  const state = matchState[sectionId];
  if (!state) return;
  document.getElementById(sectionId + '-score').textContent = '0';
  document.getElementById(sectionId + '-complete')?.classList.remove('show');
  document.getElementById(sectionId + '-lines').innerHTML = '';
  initMatch(sectionId, state.data);
}

// Redraw lines on resize for all match activities
window.addEventListener('resize', () => {
  Object.keys(matchState).forEach(sectionId => drawMatchLines(sectionId));
});


// Sort Activity - supports multiple instances
const sortState = {};

function initSort(sectionId, data) {
  const pool = document.getElementById(sectionId + '-items');
  const groupsContainer = document.getElementById(sectionId + '-groups');
  if (!pool || !groupsContainer || !data.groups || !data.groups.length) return;

  const groups = data.groups;
  const totalItems = groups.reduce((sum, g) => sum + g.items.length, 0);
  sortState[sectionId] = { score: 0, total: totalItems, dragItem: null, data: data };

  // Create group containers
  groupsContainer.innerHTML = groups.map((g, i) =>
    '<div class="sort-group" data-group="' + i + '" data-section="' + sectionId + '"><h4>' + g.name + '</h4><div class="sort-items"></div></div>'
  ).join('');

  // Flatten and shuffle all items
  const allItems = groups.flatMap((g, gi) => g.items.map(item => ({ text: item, group: gi })));
  allItems.sort(() => Math.random() - 0.5);

  // Create draggable items
  pool.innerHTML = '';
  allItems.forEach(item => {
    const el = document.createElement('div');
    el.className = 'sort-item';
    el.textContent = item.text;
    el.draggable = true;
    el.dataset.group = item.group;
    el.dataset.section = sectionId;
    el.addEventListener('dragstart', () => {
      sortState[sectionId].dragItem = el;
      el.classList.add('dragging');
    });
    el.addEventListener('dragend', () => {
      el.classList.remove('dragging');
      sortState[sectionId].dragItem = null;
    });
    pool.appendChild(el);
  });

  // Setup drop zones
  groupsContainer.querySelectorAll('.sort-group').forEach(g => {
    g.addEventListener('dragover', e => {
      e.preventDefault();
      g.classList.add('drag-over');
    });
    g.addEventListener('dragleave', () => g.classList.remove('drag-over'));
    g.addEventListener('drop', e => handleSortDrop(e, g));
  });
}

function handleSortDrop(e, groupEl) {
  e.preventDefault();
  groupEl.classList.remove('drag-over');
  const sectionId = groupEl.dataset.section;
  const state = sortState[sectionId];
  const dragItem = state.dragItem;
  if (!dragItem) return;

  if (groupEl.dataset.group === dragItem.dataset.group) {
    dragItem.classList.add('correct');
    groupEl.querySelector('.sort-items').appendChild(dragItem);
    dragItem.draggable = false;
    state.score++;
    document.getElementById(sectionId + '-score').textContent = state.score;
    if (state.score === state.total) document.getElementById(sectionId + '-complete').classList.add('show');
  } else {
    dragItem.classList.add('wrong');
    setTimeout(() => dragItem.classList.remove('wrong'), 300);
  }
}

function resetSort(sectionId) {
  const state = sortState[sectionId];
  if (!state) return;
  document.getElementById(sectionId + '-score').textContent = '0';
  document.getElementById(sectionId + '-complete')?.classList.remove('show');
  initSort(sectionId, state.data);
}


// Fill-in Activity - supports multiple instances
const fillState = {};

function initFill(sectionId, data) {
  const c = document.getElementById(sectionId + '-container');
  if (!c || !data.items || !data.items.length) return;

  fillState[sectionId] = { score: 0, answered: 0, total: data.items.length, data: data };
  c.innerHTML = '';

  data.items.forEach((item, i) => {
    const div = document.createElement('div');
    div.className = 'fill-question';
    div.dataset.section = sectionId;

    // Generate options: correct answer + 3 distractors
    let options = [];
    if (item.options && item.options.length >= 4) {
      options = item.options;
    } else {
      // Fallback: generate distractors from other items' answers
      options = [item.answer];
      const otherAnswers = data.items
        .filter((_, idx) => idx !== i)
        .map(it => it.answer)
        .filter(a => a && a !== item.answer);

      const shuffled = otherAnswers.sort(() => Math.random() - 0.5);
      options.push(...shuffled.slice(0, 3));

      while (options.length < 4) {
        options.push('‚Äî');
      }
    }

    // Shuffle options
    const shuffledOptions = [...options].sort(() => Math.random() - 0.5);

    // Replace ___ in the sentence with a dropdown
    const sentence = (item.prompt || item.sentence || '').replace(/___/g,
      `<select class="fill-dropdown" data-idx="${i}" data-answer="${item.answer}" data-section="${sectionId}">
        <option value="" disabled selected>‚Äî</option>
        ${shuffledOptions.map(opt => `<option value="${opt}">${opt}</option>`).join('')}
      </select>`
    );

    div.innerHTML = `
      <div class="fill-sentence">
        <span class="fill-number">${i + 1}.</span>
        ${sentence}
      </div>
      <div class="fill-feedback" id="${sectionId}-fb-${i}"></div>
    `;
    c.appendChild(div);
  });

  // Event delegation for dropdown changes
  c.addEventListener('change', (e) => {
    if (e.target.classList.contains('fill-dropdown')) {
      handleFillChoice(e.target);
    }
  });
}

function handleFillChoice(dropdown) {
  const q = dropdown.closest('.fill-question');
  const sectionId = dropdown.dataset.section;
  const state = fillState[sectionId];
  if (q.classList.contains('answered')) return;

  const idx = dropdown.dataset.idx;
  const userAnswer = dropdown.value;
  const correctAnswer = dropdown.dataset.answer;
  const fb = document.getElementById(sectionId + '-fb-' + idx);

  q.classList.add('answered');
  dropdown.disabled = true;

  if (userAnswer === correctAnswer) {
    dropdown.classList.add('correct');
    fb.innerHTML = '<span class="correct-text">‚úì Correct!</span>';
    state.score++;
  } else {
    dropdown.classList.add('wrong');
    fb.innerHTML = `<span class="wrong-text">‚úó Answer: ${correctAnswer}</span>`;
  }

  document.getElementById(sectionId + '-score').textContent = state.score;
  state.answered++;
  if (state.answered === state.total) {
    document.getElementById(sectionId + '-complete').classList.add('show');
  }
}

function resetFill(sectionId) {
  const state = fillState[sectionId];
  if (!state) return;
  document.getElementById(sectionId + '-score').textContent = '0';
  document.getElementById(sectionId + '-complete')?.classList.remove('show');
  initFill(sectionId, state.data);
}


// Order/Unjumble/Anagram Activity - supports multiple instances
const orderState = {};

function initOrder(sectionId, data) {
  const c = document.getElementById(sectionId + '-container');
  if (!c || !data.items || !data.items.length) return;

  orderState[sectionId] = { score: 0, total: data.items.length, data: data };
  c.innerHTML = '';

  if (data.isAnagram) {
    initAnagram(sectionId, c, data);
  } else if (data.isUnjumble) {
    initUnjumble(sectionId, c, data);
  } else {
    initClassicOrder(sectionId, c, data);
  }
}

// UNJUMBLE: Drag-and-drop words to form sentences
function initUnjumble(sectionId, container, data) {
  data.items.forEach((item, idx) => {
    const question = document.createElement('div');
    question.className = 'unjumble-question';
    question.dataset.idx = idx;
    question.dataset.section = sectionId;

    // Shuffle words
    const shuffledWords = [...item.words].sort(() => Math.random() - 0.5);

    question.innerHTML = `
      <div class="unjumble-number">${idx + 1}.</div>
      <div class="unjumble-word-row" data-idx="${idx}" data-section="${sectionId}">
        ${shuffledWords.map((word, i) => `
          <span class="unjumble-word" draggable="true" data-word="${word}">${word}</span>
        `).join('')}
      </div>
      <div class="unjumble-actions">
        <button class="btn btn-sm btn-outline unjumble-check" data-idx="${idx}" data-section="${sectionId}">Check</button>
        <button class="btn btn-sm btn-outline unjumble-reset" data-idx="${idx}" data-section="${sectionId}">Reset</button>
      </div>
      <div class="unjumble-feedback" data-idx="${idx}" data-section="${sectionId}"></div>
    `;

    container.appendChild(question);

    // Initialize drag-and-drop for this row
    initUnjumbleDragDrop(question.querySelector('.unjumble-word-row'));
  });

  // Event delegation for buttons
  container.addEventListener('click', handleUnjumbleClick);
}

function initUnjumbleDragDrop(row) {
  let dragItem = null;

  row.querySelectorAll('.unjumble-word').forEach(word => {
    word.addEventListener('dragstart', (e) => {
      dragItem = word;
      word.classList.add('dragging');
      e.dataTransfer.effectAllowed = 'move';
    });

    word.addEventListener('dragend', () => {
      word.classList.remove('dragging');
      dragItem = null;
    });

    word.addEventListener('dragover', (e) => {
      e.preventDefault();
      if (!dragItem || dragItem === word) return;

      const rect = word.getBoundingClientRect();
      const midX = rect.left + rect.width / 2;

      if (e.clientX < midX) {
        row.insertBefore(dragItem, word);
      } else {
        row.insertBefore(dragItem, word.nextSibling);
      }
    });
  });

  // Touch support for mobile
  let touchItem = null;
  let touchClone = null;

  row.querySelectorAll('.unjumble-word').forEach(word => {
    word.addEventListener('touchstart', (e) => {
      touchItem = word;
      word.classList.add('dragging');

      // Create a clone for visual feedback
      touchClone = word.cloneNode(true);
      touchClone.classList.add('touch-clone');
      document.body.appendChild(touchClone);
      updateTouchClone(e.touches[0]);
    });

    word.addEventListener('touchmove', (e) => {
      e.preventDefault();
      if (!touchItem) return;
      updateTouchClone(e.touches[0]);

      // Find which word we're over
      const touch = e.touches[0];
      const elements = document.elementsFromPoint(touch.clientX, touch.clientY);
      const targetWord = elements.find(el => el.classList.contains('unjumble-word') && el !== touchItem);

      if (targetWord && targetWord.parentNode === row) {
        const rect = targetWord.getBoundingClientRect();
        const midX = rect.left + rect.width / 2;
        if (touch.clientX < midX) {
          row.insertBefore(touchItem, targetWord);
        } else {
          row.insertBefore(touchItem, targetWord.nextSibling);
        }
      }
    });

    word.addEventListener('touchend', () => {
      if (touchItem) touchItem.classList.remove('dragging');
      if (touchClone) touchClone.remove();
      touchItem = null;
      touchClone = null;
    });
  });

  function updateTouchClone(touch) {
    if (touchClone) {
      touchClone.style.left = (touch.clientX - 40) + 'px';
      touchClone.style.top = (touch.clientY - 20) + 'px';
    }
  }
}

function handleUnjumbleClick(e) {
  const target = e.target;

  if (target.classList.contains('unjumble-check')) {
    checkUnjumbleAnswer(target.dataset.section, parseInt(target.dataset.idx));
  }

  if (target.classList.contains('unjumble-reset')) {
    resetUnjumbleQuestion(target.dataset.section, parseInt(target.dataset.idx));
  }
}

function checkUnjumbleAnswer(sectionId, idx) {
  const state = orderState[sectionId];
  const item = state.data.items[idx];
  const row = document.querySelector(`.unjumble-word-row[data-section="${sectionId}"][data-idx="${idx}"]`);
  const feedback = document.querySelector(`.unjumble-feedback[data-section="${sectionId}"][data-idx="${idx}"]`);
  const question = document.querySelector(`.unjumble-question[data-section="${sectionId}"][data-idx="${idx}"]`);

  // Build user's answer from current word order
  const words = row.querySelectorAll('.unjumble-word');
  const userAnswer = Array.from(words).map(w => w.dataset.word).join(' ');

  // Normalize for comparison (handle punctuation)
  const normalize = (s) => s.replace(/[?!.,]/g, '').toLowerCase().trim();
  const isCorrect = normalize(userAnswer) === normalize(item.answer);

  if (isCorrect) {
    question.classList.add('answered', 'correct');
    row.classList.add('correct');
    words.forEach(w => w.setAttribute('draggable', 'false'));
    state.score++;
    document.getElementById(sectionId + '-score').textContent = state.score;

    feedback.innerHTML = `
      <span class="correct-text">‚úì Correct!</span>
      <span class="translation">${item.translation || ''}</span>
    `;
    feedback.classList.add('show');

    if (state.score === state.total) {
      document.getElementById(sectionId + '-complete').classList.add('show');
    }
  } else {
    question.classList.add('wrong');
    row.classList.add('wrong');

    feedback.innerHTML = `
      <span class="wrong-text">‚úó Try again. Hint: ${item.answer}</span>
    `;
    feedback.classList.add('show');

    setTimeout(() => {
      question.classList.remove('wrong');
      row.classList.remove('wrong');
      feedback.classList.remove('show');
    }, 2000);
  }
}

function resetUnjumbleQuestion(sectionId, idx) {
  const state = orderState[sectionId];
  const item = state.data.items[idx];
  const row = document.querySelector(`.unjumble-word-row[data-section="${sectionId}"][data-idx="${idx}"]`);
  const question = document.querySelector(`.unjumble-question[data-section="${sectionId}"][data-idx="${idx}"]`);
  const feedback = document.querySelector(`.unjumble-feedback[data-section="${sectionId}"][data-idx="${idx}"]`);

  if (question.classList.contains('correct')) return;

  // Re-shuffle and rebuild
  const shuffledWords = [...item.words].sort(() => Math.random() - 0.5);
  row.innerHTML = shuffledWords.map(word => `
    <span class="unjumble-word" draggable="true" data-word="${word}">${word}</span>
  `).join('');

  initUnjumbleDragDrop(row);

  question.classList.remove('wrong');
  row.classList.remove('wrong');
  feedback.innerHTML = '';
  feedback.classList.remove('show');
}

// ANAGRAM: Drag-and-drop letters to form a single word
function initAnagram(sectionId, container, data) {
  data.items.forEach((item, idx) => {
    const question = document.createElement('div');
    question.className = 'anagram-question';
    question.dataset.idx = idx;
    question.dataset.section = sectionId;

    // Shuffle letters
    const shuffledLetters = [...item.letters].sort(() => Math.random() - 0.5);

    question.innerHTML = `
      <div class="anagram-number">${idx + 1}.</div>
      <div class="anagram-letter-row" data-idx="${idx}" data-section="${sectionId}">
        ${shuffledLetters.map((letter, i) => `
          <span class="anagram-letter" draggable="true" data-letter="${letter}">${letter}</span>
        `).join('')}
      </div>
      <div class="anagram-actions">
        <button class="btn btn-sm btn-outline anagram-check" data-idx="${idx}" data-section="${sectionId}">Check</button>
        <button class="btn btn-sm btn-outline anagram-reset" data-idx="${idx}" data-section="${sectionId}">Reset</button>
      </div>
      <div class="anagram-feedback" data-idx="${idx}" data-section="${sectionId}"></div>
    `;

    container.appendChild(question);

    // Initialize drag-and-drop for this row
    initAnagramDragDrop(question.querySelector('.anagram-letter-row'));
  });

  // Event delegation for buttons
  container.addEventListener('click', handleAnagramClick);
}

function initAnagramDragDrop(row) {
  let dragItem = null;

  row.querySelectorAll('.anagram-letter').forEach(letter => {
    letter.addEventListener('dragstart', (e) => {
      dragItem = letter;
      letter.classList.add('dragging');
      e.dataTransfer.effectAllowed = 'move';
    });

    letter.addEventListener('dragend', () => {
      letter.classList.remove('dragging');
      dragItem = null;
    });

    letter.addEventListener('dragover', (e) => {
      e.preventDefault();
      if (!dragItem || dragItem === letter) return;

      const rect = letter.getBoundingClientRect();
      const midX = rect.left + rect.width / 2;

      if (e.clientX < midX) {
        row.insertBefore(dragItem, letter);
      } else {
        row.insertBefore(dragItem, letter.nextSibling);
      }
    });
  });

  // Touch support for mobile
  let touchItem = null;
  let touchClone = null;

  row.querySelectorAll('.anagram-letter').forEach(letter => {
    letter.addEventListener('touchstart', (e) => {
      touchItem = letter;
      letter.classList.add('dragging');

      // Create a clone for visual feedback
      touchClone = letter.cloneNode(true);
      touchClone.classList.add('touch-clone');
      document.body.appendChild(touchClone);
      updateAnagramTouchClone(e.touches[0], touchClone);
    });

    letter.addEventListener('touchmove', (e) => {
      e.preventDefault();
      if (!touchItem) return;
      updateAnagramTouchClone(e.touches[0], touchClone);

      // Find which letter we're over
      const touch = e.touches[0];
      const elements = document.elementsFromPoint(touch.clientX, touch.clientY);
      const targetLetter = elements.find(el => el.classList.contains('anagram-letter') && el !== touchItem);

      if (targetLetter && targetLetter.parentNode === row) {
        const rect = targetLetter.getBoundingClientRect();
        const midX = rect.left + rect.width / 2;
        if (touch.clientX < midX) {
          row.insertBefore(touchItem, targetLetter);
        } else {
          row.insertBefore(touchItem, targetLetter.nextSibling);
        }
      }
    });

    letter.addEventListener('touchend', () => {
      if (touchItem) touchItem.classList.remove('dragging');
      if (touchClone) touchClone.remove();
      touchItem = null;
      touchClone = null;
    });
  });

  function updateAnagramTouchClone(touch, clone) {
    if (clone) {
      clone.style.left = (touch.clientX - 20) + 'px';
      clone.style.top = (touch.clientY - 20) + 'px';
    }
  }
}

function handleAnagramClick(e) {
  const target = e.target;

  if (target.classList.contains('anagram-check')) {
    checkAnagramAnswer(target.dataset.section, parseInt(target.dataset.idx));
  }

  if (target.classList.contains('anagram-reset')) {
    resetAnagramQuestion(target.dataset.section, parseInt(target.dataset.idx));
  }
}

function checkAnagramAnswer(sectionId, idx) {
  const state = orderState[sectionId];
  const item = state.data.items[idx];
  const row = document.querySelector(`.anagram-letter-row[data-section="${sectionId}"][data-idx="${idx}"]`);
  const feedback = document.querySelector(`.anagram-feedback[data-section="${sectionId}"][data-idx="${idx}"]`);
  const question = document.querySelector(`.anagram-question[data-section="${sectionId}"][data-idx="${idx}"]`);

  // Build user's answer from current letter order
  const letters = row.querySelectorAll('.anagram-letter');
  const userAnswer = Array.from(letters).map(l => l.dataset.letter).join('');

  // Compare with correct answer
  const isCorrect = userAnswer.toLowerCase() === item.answer.toLowerCase();

  if (isCorrect) {
    question.classList.add('answered', 'correct');
    row.classList.add('correct');
    letters.forEach(l => l.setAttribute('draggable', 'false'));
    state.score++;
    document.getElementById(sectionId + '-score').textContent = state.score;

    feedback.innerHTML = `
      <span class="correct-text">‚úì Correct!</span>
      <span class="translation">${item.translation || ''}</span>
    `;
    feedback.classList.add('show');

    if (state.score === state.total) {
      document.getElementById(sectionId + '-complete').classList.add('show');
    }
  } else {
    question.classList.add('wrong');
    row.classList.add('wrong');

    feedback.innerHTML = `
      <span class="wrong-text">‚úó Try again. Hint: ${item.answer}</span>
    `;
    feedback.classList.add('show');

    setTimeout(() => {
      question.classList.remove('wrong');
      row.classList.remove('wrong');
      feedback.classList.remove('show');
    }, 2000);
  }
}

function resetAnagramQuestion(sectionId, idx) {
  const state = orderState[sectionId];
  const item = state.data.items[idx];
  const row = document.querySelector(`.anagram-letter-row[data-section="${sectionId}"][data-idx="${idx}"]`);
  const question = document.querySelector(`.anagram-question[data-section="${sectionId}"][data-idx="${idx}"]`);
  const feedback = document.querySelector(`.anagram-feedback[data-section="${sectionId}"][data-idx="${idx}"]`);

  if (question.classList.contains('correct')) return;

  // Re-shuffle and rebuild
  const shuffledLetters = [...item.letters].sort(() => Math.random() - 0.5);
  row.innerHTML = shuffledLetters.map(letter => `
    <span class="anagram-letter" draggable="true" data-letter="${letter}">${letter}</span>
  `).join('');

  initAnagramDragDrop(row);

  question.classList.remove('wrong');
  row.classList.remove('wrong');
  feedback.innerHTML = '';
  feedback.classList.remove('show');
}

// CLASSIC ORDER: Drag items into correct sequence
function initClassicOrder(sectionId, container, data) {
  const state = orderState[sectionId];

  // Create array with original indices, then shuffle
  const items = [...data.items].map((item, idx) => ({ text: item, origIdx: idx }));
  // Fisher-Yates shuffle
  for (let i = items.length - 1; i > 0; i--) {
    const j = Math.floor(Math.random() * (i + 1));
    [items[i], items[j]] = [items[j], items[i]];
  }

  // Create container div for all items
  const wrapper = document.createElement('div');
  wrapper.className = 'order-items-wrapper';
  wrapper.dataset.section = sectionId;

  // Create each sentence as a draggable item
  items.forEach((item, i) => {
    const div = document.createElement('div');
    div.className = 'order-sentence-card';
    div.draggable = true;
    div.dataset.orig = item.origIdx;
    div.dataset.section = sectionId;
    div.innerHTML = '<span class="order-card-num">' + (i + 1) + '</span><span class="order-card-text">' + item.text + '</span>';
    wrapper.appendChild(div);
  });

  container.appendChild(wrapper);

  // Add buttons
  const btnDiv = document.createElement('div');
  btnDiv.className = 'order-buttons';
  btnDiv.innerHTML = '<button class="btn btn-outline order-check-btn" data-section="' + sectionId + '">Check Order</button>';
  container.appendChild(btnDiv);

  // Add feedback area
  const feedback = document.createElement('div');
  feedback.className = 'order-feedback';
  feedback.dataset.section = sectionId;
  container.appendChild(feedback);

  // Initialize drag-and-drop
  initOrderCardDragDrop(wrapper);

  // Button click handler
  btnDiv.querySelector('.order-check-btn').onclick = function() { checkOrder(sectionId); };
}

function initOrderCardDragDrop(wrapper) {
  let dragItem = null;

  wrapper.querySelectorAll('.order-sentence-card').forEach(function(card) {
    card.addEventListener('dragstart', function(e) {
      dragItem = card;
      card.classList.add('dragging');
      e.dataTransfer.effectAllowed = 'move';
    });

    card.addEventListener('dragend', function() {
      card.classList.remove('dragging');
      dragItem = null;
      updateCardNumbers(wrapper);
    });

    card.addEventListener('dragover', function(e) {
      e.preventDefault();
      if (!dragItem || dragItem === card) return;
      const rect = card.getBoundingClientRect();
      const midY = rect.top + rect.height / 2;
      if (e.clientY < midY) {
        wrapper.insertBefore(dragItem, card);
      } else {
        wrapper.insertBefore(dragItem, card.nextSibling);
      }
    });
  });

  // Touch support
  let touchItem = null;
  let touchClone = null;

  wrapper.querySelectorAll('.order-sentence-card').forEach(function(card) {
    card.addEventListener('touchstart', function(e) {
      touchItem = card;
      card.classList.add('dragging');
      touchClone = card.cloneNode(true);
      touchClone.style.position = 'fixed';
      touchClone.style.zIndex = '1000';
      touchClone.style.pointerEvents = 'none';
      touchClone.style.opacity = '0.8';
      touchClone.style.maxWidth = '90vw';
      document.body.appendChild(touchClone);
      moveTouchClone(e.touches[0]);
    });

    card.addEventListener('touchmove', function(e) {
      e.preventDefault();
      if (!touchItem) return;
      moveTouchClone(e.touches[0]);
      const touch = e.touches[0];
      const els = document.elementsFromPoint(touch.clientX, touch.clientY);
      const target = els.find(function(el) { return el.classList.contains('order-sentence-card') && el !== touchItem; });
      if (target && target.parentNode === wrapper) {
        const rect = target.getBoundingClientRect();
        const midY = rect.top + rect.height / 2;
        if (touch.clientY < midY) {
          wrapper.insertBefore(touchItem, target);
        } else {
          wrapper.insertBefore(touchItem, target.nextSibling);
        }
      }
    });

    card.addEventListener('touchend', function() {
      if (touchItem) touchItem.classList.remove('dragging');
      if (touchClone) touchClone.remove();
      touchItem = null;
      touchClone = null;
      updateCardNumbers(wrapper);
    });
  });

  function moveTouchClone(touch) {
    if (touchClone) {
      touchClone.style.left = (touch.clientX - 100) + 'px';
      touchClone.style.top = (touch.clientY - 25) + 'px';
    }
  }
}

function updateCardNumbers(wrapper) {
  wrapper.querySelectorAll('.order-sentence-card').forEach(function(card, i) {
    card.querySelector('.order-card-num').textContent = i + 1;
  });
}

function initOrderSentenceDragDrop(row) {
  let dragItem = null;

  row.querySelectorAll('.order-sentence-item').forEach(item => {
    item.addEventListener('dragstart', (e) => {
      dragItem = item;
      item.classList.add('dragging');
      e.dataTransfer.effectAllowed = 'move';
    });

    item.addEventListener('dragend', () => {
      item.classList.remove('dragging');
      dragItem = null;
      // Update numbers after drag
      updateOrderNumbers(row);
    });

    item.addEventListener('dragover', (e) => {
      e.preventDefault();
      if (!dragItem || dragItem === item) return;

      const rect = item.getBoundingClientRect();
      const midY = rect.top + rect.height / 2;

      if (e.clientY < midY) {
        row.insertBefore(dragItem, item);
      } else {
        row.insertBefore(dragItem, item.nextSibling);
      }
    });
  });

  // Touch support
  let touchItem = null;
  let touchClone = null;

  row.querySelectorAll('.order-sentence-item').forEach(item => {
    item.addEventListener('touchstart', (e) => {
      touchItem = item;
      item.classList.add('dragging');
      touchClone = item.cloneNode(true);
      touchClone.classList.add('touch-clone');
      document.body.appendChild(touchClone);
      updateTouchClonePos(e.touches[0], touchClone);
    });

    item.addEventListener('touchmove', (e) => {
      e.preventDefault();
      if (!touchItem) return;
      updateTouchClonePos(e.touches[0], touchClone);

      const touch = e.touches[0];
      const elements = document.elementsFromPoint(touch.clientX, touch.clientY);
      const target = elements.find(el => el.classList.contains('order-sentence-item') && el !== touchItem);

      if (target && target.parentNode === row) {
        const rect = target.getBoundingClientRect();
        const midY = rect.top + rect.height / 2;
        if (touch.clientY < midY) {
          row.insertBefore(touchItem, target);
        } else {
          row.insertBefore(touchItem, target.nextSibling);
        }
      }
    });

    item.addEventListener('touchend', () => {
      if (touchItem) touchItem.classList.remove('dragging');
      if (touchClone) touchClone.remove();
      touchItem = null;
      touchClone = null;
      updateOrderNumbers(row);
    });
  });

  function updateTouchClonePos(touch, clone) {
    if (clone) {
      clone.style.left = (touch.clientX - 100) + 'px';
      clone.style.top = (touch.clientY - 20) + 'px';
    }
  }
}

function updateOrderNumbers(row) {
  row.querySelectorAll('.order-sentence-item').forEach((item, i) => {
    item.querySelector('.order-num').textContent = i + 1;
  });
}

function initDragDrop(container) {
  const items = container.querySelectorAll('.order-item');
  let dragItem = null;

  items.forEach(item => {
    item.addEventListener('dragstart', (e) => {
      dragItem = item;
      item.classList.add('dragging');
    });

    item.addEventListener('dragend', () => {
      item.classList.remove('dragging');
      dragItem = null;
    });

    item.addEventListener('dragover', (e) => {
      e.preventDefault();
      if (!dragItem || dragItem === item) return;
      const rect = item.getBoundingClientRect();
      const midY = rect.top + rect.height / 2;
      if (e.clientY < midY) {
        container.insertBefore(dragItem, item);
      } else {
        container.insertBefore(dragItem, item.nextSibling);
      }
    });
  });
}

function checkOrder(sectionId) {
  const state = orderState[sectionId];
  const data = state.data;
  // Support multiple class names for order items
  let items = document.querySelectorAll('.order-sentence-card[data-section="' + sectionId + '"]');
  if (!items.length) {
    items = document.querySelectorAll('.order-sentence-item[data-section="' + sectionId + '"]');
  }
  if (!items.length) {
    items = document.querySelectorAll('.order-item[data-section="' + sectionId + '"]');
  }
  const currentOrder = Array.from(items).map(function(item) { return parseInt(item.dataset.orig); });
  const feedback = document.querySelector('.order-feedback[data-section="' + sectionId + '"]');

  let correct = true;
  currentOrder.forEach((val, idx) => {
    const expectedIdx = data.correctOrder && data.correctOrder.length ? data.correctOrder[idx] : idx;
    if (val !== expectedIdx) correct = false;
  });

  items.forEach((item, idx) => {
    const expectedIdx = data.correctOrder && data.correctOrder.length ? data.correctOrder[idx] : idx;
    if (parseInt(item.dataset.orig) === expectedIdx) {
      item.classList.add('correct');
      item.classList.remove('wrong');
    } else {
      item.classList.add('wrong');
      item.classList.remove('correct');
    }
  });

  if (correct) {
    state.score = state.total;
    document.getElementById(sectionId + '-score').textContent = state.score;
    document.getElementById(sectionId + '-complete').classList.add('show');
    if (feedback) {
      feedback.innerHTML = '<span class="correct-text">‚úì Perfect order!</span>';
      feedback.classList.add('show');
    }
  } else {
    if (feedback) {
      feedback.innerHTML = '<span class="wrong-text">‚úó Not quite right. Try again!</span>';
      feedback.classList.add('show');
    }
    setTimeout(function() {
      items.forEach(function(item) { item.classList.remove('wrong'); });
      if (feedback) feedback.classList.remove('show');
    }, 2000);
  }
}

function resetOrder(sectionId) {
  const state = orderState[sectionId];
  if (!state) return;
  document.getElementById(sectionId + '-score').textContent = '0';
  document.getElementById(sectionId + '-complete')?.classList.remove('show');
  initOrder(sectionId, state.data);
}


// Select Activity - supports multiple instances
const selectState = {};

function initSelect(sectionId, data) {
  const c = document.getElementById(sectionId + '-container');
  if (!c || !data.items || !data.items.length) return;

  selectState[sectionId] = { score: 0, answered: 0, total: data.items.length, data: data };
  c.innerHTML = '';

  data.items.forEach((item, idx) => {
    const div = document.createElement('div');
    div.className = 'select-question';
    div.dataset.section = sectionId;
    div.dataset.idx = idx;

    const optionsHtml = item.options.map((opt, oi) =>
      `<label class="select-option" data-correct="${opt.correct}" data-section="${sectionId}" data-idx="${idx}">
        <input type="checkbox" class="select-checkbox" data-oi="${oi}">
        <span class="select-text">${opt.text}</span>
      </label>`
    ).join('');

    div.innerHTML = `
      <div class="select-number">${idx + 1}.</div>
      <div class="select-content">
        <p class="select-prompt">${item.question}</p>
        <div class="select-options">${optionsHtml}</div>
        <button class="btn btn-sm btn-outline select-check" data-section="${sectionId}" data-idx="${idx}">Check</button>
        <div class="select-feedback" id="${sectionId}-fb-${idx}"></div>
      </div>
    `;
    c.appendChild(div);
  });

  // Event delegation for check buttons
  c.addEventListener('click', (e) => {
    if (e.target.classList.contains('select-check')) {
      checkSelectAnswer(e.target.dataset.section, parseInt(e.target.dataset.idx));
    }
  });
}

function checkSelectAnswer(sectionId, idx) {
  const state = selectState[sectionId];
  const item = state.data.items[idx];
  const question = document.querySelector(`.select-question[data-section="${sectionId}"][data-idx="${idx}"]`);
  const fb = document.getElementById(sectionId + '-fb-' + idx);

  if (question.classList.contains('answered')) return;

  const options = question.querySelectorAll('.select-option');
  let allCorrect = true;

  options.forEach(opt => {
    const checkbox = opt.querySelector('.select-checkbox');
    const isChecked = checkbox.checked;
    const shouldBeChecked = opt.dataset.correct === 'true';

    if (isChecked === shouldBeChecked) {
      opt.classList.add(shouldBeChecked ? 'correct' : 'correct-unchecked');
    } else {
      opt.classList.add(shouldBeChecked ? 'missed' : 'wrong');
      allCorrect = false;
    }
    checkbox.disabled = true;
  });

  question.classList.add('answered');

  if (allCorrect) {
    fb.innerHTML = '<span class="correct-text">‚úì Perfect!</span>';
    state.score++;
  } else {
    fb.innerHTML = '<span class="wrong-text">‚úó Some answers were incorrect.</span>';
  }
  fb.classList.add('show');

  document.getElementById(sectionId + '-score').textContent = state.score;
  state.answered++;

  if (state.answered === state.total) {
    document.getElementById(sectionId + '-complete').classList.add('show');
  }
}

function resetSelect(sectionId) {
  const state = selectState[sectionId];
  if (!state) return;
  document.getElementById(sectionId + '-score').textContent = '0';
  document.getElementById(sectionId + '-complete')?.classList.remove('show');
  initSelect(sectionId, state.data);
}


// Error-Correction Activity
// Two-step interaction: 1) Click wrong word, 2) Select correct form
const errorState = {};

function initErrorCorrection(sectionId, data) {
  const c = document.getElementById(sectionId + '-container');
  if (!c || !data.items || !data.items.length) return;

  errorState[sectionId] = {
    score: 0,
    completed: 0,
    total: data.items.length,
    data: data
  };
  c.innerHTML = '';

  data.items.forEach((item, i) => {
    const div = document.createElement('div');
    div.className = 'error-item';
    div.dataset.section = sectionId;
    div.dataset.idx = i;

    // Parse sentence into clickable words
    const words = item.sentence.split(/(\s+)/);
    const wordsHtml = words.map((word, wi) => {
      if (/^\s+$/.test(word)) return word; // preserve whitespace
      const isError = item.errorWord && word.replace(/[.,!?;:]/g, '') === item.errorWord;
      return `<span class="error-word" data-word="${word.replace(/[.,!?;:]/g, '')}" data-is-error="${isError}">${word}</span>`;
    }).join('');

    const hasNoError = item.errorWord === null;

    div.innerHTML = `
      <div class="error-sentence" id="${sectionId}-sentence-${i}">
        <span class="error-number">${i + 1}.</span>
        <span class="error-words">${wordsHtml}</span>
        ${hasNoError ? '' : ''}
      </div>
      <div class="error-no-error-btn" id="${sectionId}-noerror-${i}">
        <button class="btn btn-outline btn-sm" onclick="handleNoError('${sectionId}', ${i})">No error</button>
      </div>
      <div class="error-options" id="${sectionId}-options-${i}" style="display:none;">
        <span class="error-prompt">Choose the correct form:</span>
        <div class="error-option-btns">
          ${(item.options || []).map(opt =>
            `<button class="btn btn-outline btn-sm error-option"
                     data-option="${opt}"
                     data-correct="${opt === item.correctForm}"
                     onclick="handleErrorOption('${sectionId}', ${i}, '${opt}', ${opt === item.correctForm})">${opt}</button>`
          ).join('')}
        </div>
      </div>
      <div class="error-feedback" id="${sectionId}-fb-${i}" style="display:none;"></div>
    `;

    c.appendChild(div);
  });

  // Event delegation for word clicks
  c.addEventListener('click', (e) => {
    const wordEl = e.target.closest('.error-word');
    if (wordEl && !wordEl.closest('.error-item').classList.contains('completed')) {
      const item = wordEl.closest('.error-item');
      handleWordClick(item.dataset.section, parseInt(item.dataset.idx), wordEl);
    }
  });
}

function handleWordClick(sectionId, idx, wordEl) {
  const state = errorState[sectionId];
  const item = state.data.items[idx];
  const itemEl = document.querySelector(`.error-item[data-section="${sectionId}"][data-idx="${idx}"]`);

  if (itemEl.classList.contains('step2') || itemEl.classList.contains('completed')) return;

  // Clear previous selection in this item
  itemEl.querySelectorAll('.error-word.selected').forEach(w => w.classList.remove('selected'));

  const clickedWord = wordEl.dataset.word;
  const isError = wordEl.dataset.isError === 'true';

  if (isError) {
    // Correct identification! Move to step 2
    wordEl.classList.add('selected', 'found');
    itemEl.classList.add('step2');
    state.score++;
    document.getElementById(sectionId + '-score').textContent = state.score;

    // Hide no-error button, show options
    document.getElementById(`${sectionId}-noerror-${idx}`).style.display = 'none';
    document.getElementById(`${sectionId}-options-${idx}`).style.display = 'block';
  } else {
    // Wrong word selected
    wordEl.classList.add('selected', 'wrong-selection');
    setTimeout(() => wordEl.classList.remove('selected', 'wrong-selection'), 500);
  }
}

function handleNoError(sectionId, idx) {
  const state = errorState[sectionId];
  const item = state.data.items[idx];
  const itemEl = document.querySelector(`.error-item[data-section="${sectionId}"][data-idx="${idx}"]`);
  const fb = document.getElementById(`${sectionId}-fb-${idx}`);

  if (itemEl.classList.contains('completed')) return;

  itemEl.classList.add('completed');
  document.getElementById(`${sectionId}-noerror-${idx}`).style.display = 'none';

  if (item.errorWord === null) {
    // Correct! No error in this sentence
    state.score += 2; // Full points for no-error items
    fb.innerHTML = `<span class="correct-text">Correct! No error in this sentence.</span>`;
    if (item.explanation) {
      fb.innerHTML += `<div class="error-explanation">${item.explanation}</div>`;
    }
  } else {
    // Wrong - there was an error
    fb.innerHTML = `<span class="wrong-text">There was an error: <strong>${item.errorWord}</strong> ‚Üí <strong>${item.correctForm}</strong></span>`;
    if (item.explanation) {
      fb.innerHTML += `<div class="error-explanation">${item.explanation}</div>`;
    }
  }

  fb.style.display = 'block';
  document.getElementById(sectionId + '-score').textContent = state.score;

  state.completed++;
  checkComplete(sectionId);
}

function handleErrorOption(sectionId, idx, option, isCorrect) {
  const state = errorState[sectionId];
  const item = state.data.items[idx];
  const itemEl = document.querySelector(`.error-item[data-section="${sectionId}"][data-idx="${idx}"]`);
  const fb = document.getElementById(`${sectionId}-fb-${idx}`);
  const optionsEl = document.getElementById(`${sectionId}-options-${idx}`);

  if (itemEl.classList.contains('completed')) return;

  itemEl.classList.add('completed');

  // Highlight correct/wrong options
  optionsEl.querySelectorAll('.error-option').forEach(btn => {
    btn.disabled = true;
    if (btn.dataset.correct === 'true') {
      btn.classList.add('correct');
    } else if (btn.dataset.option === option && !isCorrect) {
      btn.classList.add('wrong');
    }
  });

  if (isCorrect) {
    state.score++;
    fb.innerHTML = `<span class="correct-text">Correct!</span>`;
  } else {
    fb.innerHTML = `<span class="wrong-text">The correct form is: <strong>${item.correctForm}</strong></span>`;
  }

  if (item.explanation) {
    fb.innerHTML += `<div class="error-explanation">${item.explanation}</div>`;
  }

  fb.style.display = 'block';
  document.getElementById(sectionId + '-score').textContent = state.score;

  state.completed++;
  checkComplete(sectionId);
}

function checkComplete(sectionId) {
  const state = errorState[sectionId];
  if (state.completed === state.total) {
    document.getElementById(sectionId + '-complete').classList.add('show');
  }
}

function resetErrorCorrection(sectionId) {
  const state = errorState[sectionId];
  if (!state) return;
  document.getElementById(sectionId + '-score').textContent = '0';
  document.getElementById(sectionId + '-complete')?.classList.remove('show');
  initErrorCorrection(sectionId, state.data);
}


// Vocabulary
function initVocab() {
  const grid = document.getElementById('vocab-grid');
  if (!grid) return;
  grid.innerHTML = '';
  vocabData.forEach(v => {
    const card = document.createElement('div');
    card.className = 'vocab-card';
    card.innerHTML = '<div class="uk">' + v.uk + '</div><div class="translit">' + v.translit + '</div><div class="en">' + v.en + '</div>' + (v.note ? '<div class="note">' + v.note + '</div>' : '');
    grid.appendChild(card);
  });
}

  </script>
</body>
</html>