# Ukrainian Lessons Resources: Mapping Methodology

**Version:** 1.0
**Date:** 2026-01-02
**Status:** Pending user approval
**Scope:** Map 240 ULP podcast episodes + 28 blog articles to 328 curriculum modules

---

## 1. Priority Level Definitions

Resources are assigned a **priority score (1-5)** where **1 = highest priority** (appears first in output).

### Priority 1: Critical/Essential (Ukrainian Lessons Primary Content)

**Criteria - ALL must be met:**
- ✅ Resource is from **Ukrainian Lessons Podcast (ULP/FMU) or blog**
- ✅ Topic **directly matches** module's primary grammar/vocabulary focus
- ✅ CEFR level **exactly matches** module level (±0 levels)
- ✅ Content type aligns with module type (grammar article → grammar module, vocab list → vocab module)

**Examples:**
- ULP Episode "Genitive Case" → A1 M16 "The Genitive I: Absence"
- Blog article "Accusative Case in Ukrainian" → A1 M11 "The Accusative I: Things"
- Blog article "40+ Ukrainian Dishes" → A1 M09 "Food and Drinks"

**Display:** First in `[!resources]` callout, sorted alphabetically within priority group

---

### Priority 2: High Relevance (Ukrainian Lessons Supplementary Content)

**Criteria - At least 3 of 4:**
- ✅ Resource is from **Ukrainian Lessons**
- ✅ Topic **strongly related** to module (partial match or important supplementary context)
- ✅ CEFR level **within ±1 level** of module (e.g., A1 resource for A2 module)
- ✅ Vocabulary overlap **≥30%** (estimated)

**Examples:**
- Blog article "Ukrainian Cases Chart" → A1 M11 "The Accusative I" (comprehensive reference, all cases)
- ULP Episode "Greetings" → A1 M04 "This is / I am" (conversation context, not exact topic)
- Blog article "Family Vocabulary" → A1 M14 "Mine and Yours" (possessive context, related vocabulary)

**Display:** After Priority 1, before non-ULP sources

---

### Priority 3: Moderate Relevance (Other High-Quality Sources)

**Criteria:**
- Resource is **NOT from Ukrainian Lessons** (e.g., Ukrainian with Olena, Real Ukrainian, external dictionaries)
- Topic matches or strongly relates to module
- Quality resource (trusted source, comprehensive content)

**Examples:**
- YouTube video "Ukrainian with Olena: Genitive Case" → A1 M16 "The Genitive I"
- Website "Talk Ukrainian - Alphabet" → A1 M01 "The Cyrillic Code I"

**Display:** After Priority 1-2

---

### Priority 4: General Supplementary (Tangential or Review)

**Criteria - At least 2 of 3:**
- Topic is **tangentially related** to module (provides context but not core content)
- CEFR level **±2+ levels** from module (e.g., A1 resource for B1 module as review)
- Vocabulary overlap **10-29%**

**Examples:**
- Blog article "Learning Ukrainian Vocabulary" → A1 M09 "Food and Drinks" (general study tips)
- ULP Episode "Greetings" → B1 M54 "Expressing Opinions" (beginner listening practice)

**Display:** After Priority 1-3

---

### Priority 5: Background/Culture (Minimal Direct Relevance)

**Criteria:**
- Resource provides **cultural context** or **background knowledge** but minimal language instruction
- Topic does not directly teach module grammar/vocabulary
- May be useful for motivation or cultural understanding

**Examples:**
- Blog article "Things to Do in Kyiv" → B1 M72 "Regions: West" (cultural background)
- Blog article "Ukrainian Superstitions" → B1 M85 "Ukrainian Cuisine" (cultural context)

**Display:** Last in resources list

---

### No Mapping (Threshold Not Met)

**Do NOT map if:**
- ❌ No topic overlap with module
- ❌ Resource level is ≥3 levels different (e.g., C1 resource for A1 module)
- ❌ Content type completely misaligned (e.g., literature analysis for beginner alphabet module)

---

## 2. Relevance Scoring Criteria

### Matching Dimensions

**Each dimension scores 0-25 points. Total = 0-100.**

#### Dimension 1: Grammar/Topic Match (0-25 points)

| Score | Criteria | Example |
|-------|----------|---------|
| 25 | **Exact match** - Resource teaches the exact grammar/vocab topic | Genitive case article → Genitive module |
| 20 | **Core match** - Resource covers topic as main focus + related concepts | All cases article → Genitive module |
| 15 | **Partial match** - Resource includes topic but not primary focus | Verb conjugation article → Present tense module |
| 10 | **Tangential** - Topic appears briefly or as example | Conversation article mentioning cases → Genitive module |
| 0 | **No match** - Topic not covered | Food vocabulary → Genitive module |

#### Dimension 2: CEFR Level Match (0-25 points)

| Score | Criteria | Example |
|-------|----------|---------|
| 25 | **Exact level** - Resource and module same CEFR level | A1 resource → A1 module |
| 20 | **Adjacent level** - ±1 level (resource can be review or preview) | A1 resource → A2 module (review) |
| 10 | **Two levels apart** - ±2 levels (significant gap) | A1 resource → B1 module (basic review) |
| 0 | **Three+ levels apart** - ±3+ levels (not relevant) | A1 resource → C1 module |

#### Dimension 3: Content Type Alignment (0-25 points)

| Score | Criteria | Example |
|-------|----------|---------|
| 25 | **Perfect alignment** - Content type matches module type | Grammar guide → Grammar module |
| 20 | **Strong alignment** - Complementary content types | Podcast episode → Written module (listening practice) |
| 15 | **Moderate alignment** - Related but different format | Vocabulary list → Grammar module using those words |
| 10 | **Weak alignment** - Content type marginally useful | Cultural article → Grammar module |
| 0 | **Misaligned** - Content type not applicable | Literature analysis → A1 alphabet module |

#### Dimension 4: Source Priority Bonus (0-25 points)

| Score | Criteria | Source |
|-------|----------|--------|
| 25 | **Ukrainian Lessons primary** - ULP podcast or core blog article | ULP episode, grammar guide blog |
| 20 | **Ukrainian Lessons secondary** - Supplementary blog content | Study tips blog, cultural blog |
| 15 | **Trusted external** - High-quality established sources | Ukrainian with Olena, Real Ukrainian |
| 10 | **General external** - Quality but less specialized | Generic dictionaries, Wikipedia |
| 0 | **Unreliable/unknown** - Untrusted or low-quality | Random YouTube, unverified blogs |

---

### Relevance Score → Priority Mapping

| Total Score | Priority | Mapping Decision |
|-------------|----------|------------------|
| **90-100** | **1** (Critical) | Map as essential resource |
| **75-89** | **2** (High) | Map as important supplementary |
| **60-74** | **3** (Moderate) | Map as additional resource |
| **45-59** | **4** (General) | Map as background/review |
| **30-44** | **5** (Culture) | Map as cultural context |
| **0-29** | **No mapping** | Do not include (too low relevance) |

---

### Decision Tree (Quick Reference)

```
START: Resource + Module pair

├─ Is resource from Ukrainian Lessons? (ULP/FMU/blog)
│  ├─ YES → +25 bonus points
│  └─ NO → +10-15 bonus (if trusted external)
│
├─ Topic match score
│  ├─ Exact match → +25
│  ├─ Core match → +20
│  ├─ Partial → +15
│  ├─ Tangential → +10
│  └─ None → +0
│
├─ CEFR level match score
│  ├─ Same level → +25
│  ├─ ±1 level → +20
│  ├─ ±2 levels → +10
│  └─ ±3+ levels → +0
│
├─ Content type match score
│  ├─ Perfect → +25
│  ├─ Strong → +20
│  ├─ Moderate → +15
│  ├─ Weak → +10
│  └─ Misaligned → +0
│
TOTAL SCORE (0-100) → Priority (1-5 or no mapping)
```

---

## 3. Sample Mappings

### Example 1: Perfect Match (Priority 1)

**Resource:** ULP Episode #012 "Ordering food in Ukrainian"
- **Type:** Podcast
- **Level:** A1 (Season 1)
- **Topics:** food, ordering, restaurant vocabulary
- **URL:** https://www.ukrainianlessons.com/lesson/12/

**Target Module:** A1 M09 "Food and Drinks"
- **Module level:** A1
- **Module topics:** food vocabulary, eating/drinking verbs, "Смачного!"
- **Vocabulary:** борщ, каві, хліб, їсти, пити, etc.

**Scoring:**
- Grammar/Topic: 25 (exact match - food vocabulary and phrases)
- CEFR Level: 25 (both A1)
- Content Type: 25 (podcast supplements written module)
- Source Bonus: 25 (Ukrainian Lessons primary content)
- **TOTAL: 100**

**Mapping Decision:**
- **Priority:** 1 (Critical)
- **match_reason:** "Level-aligned topic match: food and restaurant"

**Alternative modules:** A1 M19 "At the Café" (Priority 1 also - episode relevant to both)

---

### Example 2: Strong Match (Priority 2)

**Resource:** Blog article "Ukrainian Cases Chart"
- **Type:** Blog article (reference chart)
- **Level:** A2 (comprehensive, all cases)
- **Topics:** all 7 cases, declension patterns
- **URL:** https://www.ukrainianlessons.com/ukrainian-cases-chart/

**Target Module:** A1 M11 "The Accusative I: Things"
- **Module level:** A1
- **Module topics:** Accusative case introduction, direct objects
- **Vocabulary:** Limited to accusative examples

**Scoring:**
- Grammar/Topic: 20 (core match - covers accusative + all other cases)
- CEFR Level: 20 (A2 resource for A1 module - preview/reference)
- Content Type: 20 (reference chart complements tutorial)
- Source Bonus: 25 (Ukrainian Lessons blog)
- **TOTAL: 85**

**Mapping Decision:**
- **Priority:** 2 (High relevance)
- **match_reason:** "Comprehensive case reference including accusative"

**Alternative modules:**
- A1 M13 "The Locative" (Priority 2)
- A1 M16 "The Genitive I" (Priority 2)
- A2 M01 "The Dative I" (Priority 1 - better level match)

---

### Example 3: Moderate Match (Priority 3)

**Resource:** YouTube "Ukrainian with Olena: Alphabet Song"
- **Type:** YouTube video
- **Level:** A1
- **Topics:** Cyrillic alphabet, pronunciation
- **URL:** https://www.youtube.com/example (external source)

**Target Module:** A1 M01 "The Cyrillic Code I"
- **Module level:** A1
- **Module topics:** Cyrillic letters, basic sounds, vowels/consonants

**Scoring:**
- Grammar/Topic: 25 (exact match - alphabet)
- CEFR Level: 25 (both A1)
- Content Type: 20 (video supplements written lesson)
- Source Bonus: 15 (trusted external, not ULP)
- **TOTAL: 85 BUT external source → Priority 3**

**Mapping Decision:**
- **Priority:** 3 (Moderate - external source despite high relevance)
- **Rationale:** Non-ULP sources get Priority 3+ even with good topic match

**Note:** Ukrainian Lessons gets Priority 1-2 preference. External sources cap at Priority 3.

---

### Example 4: General Supplementary (Priority 4)

**Resource:** Blog article "How to Learn Ukrainian Vocabulary"
- **Type:** Blog article (methodology)
- **Level:** A1-B2 (general study tips)
- **Topics:** vocabulary learning strategies, spaced repetition, flashcards
- **URL:** https://www.ukrainianlessons.com/learning-ukrainian-vocabulary/

**Target Module:** A1 M09 "Food and Drinks"
- **Module level:** A1
- **Module topics:** Food vocabulary

**Scoring:**
- Grammar/Topic: 10 (tangential - general vocab tips, not food-specific)
- CEFR Level: 25 (matches A1)
- Content Type: 10 (methodology article, not vocabulary instruction)
- Source Bonus: 25 (Ukrainian Lessons blog)
- **TOTAL: 70**

**Mapping Decision:**
- **Priority:** 4 (General supplementary)
- **match_reason:** "General vocabulary learning strategies"

**Alternative approach:** Map this article to **multiple modules** at Priority 4-5 (any vocabulary-heavy module benefits from study tips)

---

### Example 5: Cultural Context (Priority 5)

**Resource:** Blog article "Ukrainian Superstitions"
- **Type:** Blog article (cultural)
- **Level:** B1 (cultural concepts)
- **Topics:** folklore, beliefs, traditions, superstitions
- **URL:** https://www.ukrainianlessons.com/ukrainian-superstitions/

**Target Module:** B1 M85 "Ukrainian Cuisine"
- **Module level:** B1
- **Module topics:** Traditional dishes, cooking, regional cuisine

**Scoring:**
- Grammar/Topic: 5 (minimal overlap - both cultural, but different topics)
- CEFR Level: 25 (both B1)
- Content Type: 15 (cultural article → cultural module, moderate fit)
- Source Bonus: 25 (Ukrainian Lessons blog)
- **TOTAL: 70 BUT cultural context only → Priority 5**

**Mapping Decision:**
- **Priority:** 5 (Cultural background)
- **match_reason:** "Cultural context for understanding Ukrainian traditions"

**Better target:** B1 M77 "Ukrainian Customs" (Priority 2-3 - direct topic match)

---

### Example 6: No Mapping

**Resource:** Blog article "Taras Shevchenko - Ukraine's National Poet"
- **Type:** Blog article (biography)
- **Level:** B2 (historical/literary)
- **Topics:** Shevchenko biography, poetry, national identity

**Target Module:** A1 M01 "The Cyrillic Code I"
- **Module level:** A1
- **Module topics:** Alphabet, basic sounds

**Scoring:**
- Grammar/Topic: 0 (no overlap - biography vs alphabet)
- CEFR Level: 0 (B2 resource for A1 module - 2+ levels apart)
- Content Type: 0 (biography vs alphabet tutorial - completely misaligned)
- Source Bonus: 25 (Ukrainian Lessons blog)
- **TOTAL: 25 → Below threshold (30)**

**Mapping Decision:**
- **No mapping** - Relevance too low
- **Better target:** B2 M100 "Shevchenko: Awakening" (Priority 1 - exact match!)

---

### Example 7: Multi-Module Mapping (Episode Reuse)

**Resource:** ULP Episode #001 "Informal Greetings in Ukrainian"
- **Type:** Podcast
- **Level:** A1
- **Topics:** Привіт, Добрий день, До побачення, introductions

**Multiple Target Modules:**

**Primary mapping:**
1. **A1 M04 "This is / I am"** → Priority 1
   - Exact topic match (greetings + introductions)
   - Same level (A1)
   - **Score: 100**

**Secondary mappings (listening practice/review):**
2. **A2 M10 "Small Talk"** → Priority 2
   - Related topic (conversation basics)
   - Adjacent level (A2 - review)
   - **Score: 80**

3. **B1 M54 "Expressing Opinions"** → Priority 4
   - Tangential (beginner listening practice)
   - Distant level (B1 - basic review)
   - **Score: 50**

**Rationale:** Beginner ULP episodes can appear in multiple modules at decreasing priority (review/listening practice for higher levels)

---

### Example 8: Edge Case - Grammar Article for Vocab Module

**Resource:** Blog article "Reflexive Verbs in Ukrainian"
- **Type:** Blog article (grammar guide)
- **Level:** B1
- **Topics:** Reflexive verbs (-ся/-сь), conjugation, usage

**Target Module:** B1 M65 "Relationships" (vocabulary module)
- **Module level:** B1
- **Module topics:** Relationship vocabulary, emotions, describing people
- **Vocabulary includes:** закохуватися (to fall in love), сподіватися (to hope), радіти (to be happy)

**Scoring:**
- Grammar/Topic: 15 (partial - module uses reflexive verbs but doesn't teach them)
- CEFR Level: 25 (both B1)
- Content Type: 15 (grammar guide → vocabulary module, moderate fit)
- Source Bonus: 25 (Ukrainian Lessons blog)
- **TOTAL: 80**

**Mapping Decision:**
- **Priority:** 2 (High relevance)
- **match_reason:** "Grammar reference for reflexive verbs used in module vocabulary"

**Better target:** B1 M31 "Reflexive Verbs" (if exists - Priority 1)

---

### Example 9: Podcast Episode with Pronunciation Trainer

**Resource:** ULP Episode #005 "Numbers 1-20 + Pronunciation Trainer (и)"
- **Type:** Podcast
- **Level:** A1
- **Topics:** Numbers, pronunciation of Ukrainian 'и' sound

**Target Module:** A1 M17 "Numbers and Money"
- **Module level:** A1
- **Module topics:** Numbers 1-100, money, prices

**Scoring:**
- Grammar/Topic: 25 (exact match - numbers 1-20)
- CEFR Level: 25 (both A1)
- Content Type: 25 (podcast with audio - excellent for number pronunciation)
- Source Bonus: 25 (Ukrainian Lessons primary)
- **TOTAL: 100**

**Mapping Decision:**
- **Priority:** 1 (Critical)
- **match_reason:** "Level-aligned topic match: numbers 1-20 with pronunciation"

**Note:** Pronunciation trainers are especially valuable (audio resource for spoken practice)

---

### Example 10: Blog Article Partial Match

**Resource:** Blog article "14 Basic Ukrainian Phrases"
- **Type:** Blog article (phrasebook)
- **Level:** A1
- **Topics:** Common phrases (hello, thank you, please, excuse me, etc.)

**Target Module:** A1 M04 "This is / I am"
- **Module level:** A1
- **Module topics:** Це, Я є, introductions, basic statements

**Scoring:**
- Grammar/Topic: 15 (partial - some phrases overlap, but article is broader)
- CEFR Level: 25 (both A1)
- Content Type: 20 (phrasebook supplements beginner module)
- Source Bonus: 25 (Ukrainian Lessons blog)
- **TOTAL: 85**

**Mapping Decision:**
- **Priority:** 2 (High relevance)
- **match_reason:** "Essential beginner phrases including introductions"

**Alternative:** Map to **multiple A1 modules** (M04, M07, M19, etc.) at Priority 2-3 as general beginner reference

---

## 4. Automation Strategy

### Overview

**Challenge:** Map 268 resources (240 ULP episodes + 28 blog articles) to 328 modules
- Potential combinations: 268 × 328 = **87,904 pairs** to evaluate
- Manual review: ~30 seconds per pair = **732 hours** (not feasible)
- **Solution:** Automated scoring with manual review checkpoints

---

### Phase 1: Data Preparation (30 minutes)

**Extract metadata from all sources:**

**1.1 Ukrainian Lessons Resources**
```bash
# Already complete
cat docs/resources/ukrainianlessons/blog_db.json  # 28 articles
jq '.[] | select(.id | startswith("ULP-"))' docs/resources/podcasts/podcast_db.json  # 240 episodes
```

**1.2 Curriculum Module Metadata**
```bash
# Extract from all modules
for level in a1 a2 b1 b2 c1 c2; do
  for module in curriculum/l2-uk-en/$level/*.md; do
    # Parse frontmatter: title, level, module_num, topics
    # Extract H2 headers (section topics)
    # Extract vocabulary words (for overlap calculation)
  done
done
```

**Output:** `module_metadata.json`
```json
{
  "a1-01-the-cyrillic-code-i": {
    "level": "A1",
    "module_num": 1,
    "title": "The Cyrillic Code I",
    "topics": ["alphabet", "cyrillic", "pronunciation", "vowels"],
    "vocabulary_words": ["а", "б", "в", "г", ...],
    "section_headers": ["Warm-up", "Vowels", "Consonants", ...]
  },
  ...
}
```

---

### Phase 2: Automated Relevance Scoring (2 hours)

**2.1 Create Scoring Script**

**File:** `scripts/score_resource_module_pairs.py`

**Algorithm:**
```python
def score_pair(resource, module):
    """Calculate relevance score (0-100) for resource-module pair."""

    # Dimension 1: Topic match (0-25)
    topic_score = calculate_topic_match(
        resource_topics=resource['topics'],
        module_topics=module['topics'],
        resource_title=resource['title'],
        module_title=module['title']
    )

    # Dimension 2: CEFR level match (0-25)
    level_score = calculate_level_match(
        resource_level=resource['suggested_level'],
        module_level=module['level']
    )

    # Dimension 3: Content type alignment (0-25)
    content_score = calculate_content_alignment(
        resource_type=resource['content_type'],
        module_type=infer_module_type(module)
    )

    # Dimension 4: Source priority bonus (0-25)
    source_score = calculate_source_priority(
        resource_source=resource.get('source', 'ukrainianlessons')
    )

    total_score = topic_score + level_score + content_score + source_score
    priority = score_to_priority(total_score)

    return {
        'total_score': total_score,
        'priority': priority,
        'breakdown': {
            'topic': topic_score,
            'level': level_score,
            'content': content_score,
            'source': source_score
        }
    }
```

**Topic Matching (Keyword-based):**
```python
def calculate_topic_match(resource_topics, module_topics, resource_title, module_title):
    """Calculate topic overlap using keyword matching."""

    # Extract keywords from titles
    resource_keywords = extract_keywords(resource_title) + resource_topics
    module_keywords = extract_keywords(module_title) + module_topics

    # Calculate overlap
    overlap = set(resource_keywords) & set(module_keywords)
    overlap_ratio = len(overlap) / max(len(resource_keywords), 1)

    # Score based on overlap
    if overlap_ratio >= 0.6:  # 60%+ overlap
        return 25  # Exact match
    elif overlap_ratio >= 0.4:  # 40-59%
        return 20  # Core match
    elif overlap_ratio >= 0.2:  # 20-39%
        return 15  # Partial match
    elif overlap_ratio >= 0.1:  # 10-19%
        return 10  # Tangential
    else:
        return 0   # No match
```

**2.2 Run Batch Scoring**
```bash
.venv/bin/python scripts/score_resource_module_pairs.py \
  --resources docs/resources/ukrainianlessons/blog_db.json \
  --resources docs/resources/podcasts/podcast_db.json \
  --modules module_metadata.json \
  --output resource_module_scores.json \
  --threshold 30  # Only save pairs scoring ≥30
```

**Output:** `resource_module_scores.json`
```json
{
  "ulp-blog-002": {  // "Accusative Case in Ukrainian"
    "a1-11-the-accusative-i-things": {
      "total_score": 100,
      "priority": 1,
      "breakdown": {"topic": 25, "level": 25, "content": 25, "source": 25}
    },
    "a1-12-the-accusative-ii-people": {
      "total_score": 95,
      "priority": 1,
      "breakdown": {"topic": 25, "level": 25, "content": 20, "source": 25}
    }
  },
  ...
}
```

---

### Phase 3: Manual Review & Refinement (1-2 hours)

**3.1 Review Priority 1 Mappings (Critical)**

**Extract all Priority 1 assignments:**
```bash
jq '.[] | to_entries[] | select(.value.priority == 1)' resource_module_scores.json > priority1_review.json
```

**Review criteria:**
- ✅ Topic match makes sense
- ✅ No false positives (keyword collision)
- ✅ Resource actually teaches module topic (verify by reading resource if uncertain)

**Action:** Manually adjust priority if needed (1 → 2, or remove mapping)

**3.2 Spot-Check Priority 2-3 (10% sample)**

**Random sample:**
```bash
jq '.[] | to_entries[] | select(.value.priority == 2 or .value.priority == 3)' resource_module_scores.json \
  | shuf | head -20 > priority23_sample.json
```

**Review:** Verify scoring logic is working correctly

**3.3 Flag Ambiguous Cases**

**Patterns to flag for manual review:**
- Resource maps to 5+ modules at Priority 1 (too broad? or genuinely useful everywhere?)
- Resource maps to 0 modules (unmapped - is it useful? should threshold be lowered?)
- Very similar resources map to same module (redundant? keep both?)

---

### Phase 4: Update external_resources.yaml (1 hour)

**4.1 Generate YAML Additions**

**Script:** `scripts/update_resources_yaml.py`

**Logic:**
```python
def update_external_resources(scores_file, current_yaml):
    """Add new mappings to existing external_resources.yaml."""

    # Load current resources
    current_resources = yaml.safe_load(current_yaml)

    # Load scored mappings
    scored_mappings = json.load(scores_file)

    # For each resource-module pair scoring ≥30:
    for resource_id, module_mappings in scored_mappings.items():
        resource = get_resource_by_id(resource_id)

        for module_id, score_data in module_mappings.items():
            # Skip if below threshold
            if score_data['total_score'] < 30:
                continue

            # Get or create module entry
            if module_id not in current_resources['resources']:
                current_resources['resources'][module_id] = {}

            # Determine resource type (podcasts/articles/websites/etc.)
            resource_type = get_resource_type(resource)

            # Add resource with priority
            if resource_type not in current_resources['resources'][module_id]:
                current_resources['resources'][module_id][resource_type] = []

            current_resources['resources'][module_id][resource_type].append({
                'episode_id' if resource_type == 'podcasts' else 'id': resource_id,
                'title': resource['title'],
                'url': resource['url'],
                'relevance': 'high',  # Map from priority
                'priority': score_data['priority'],  # NEW FIELD
                'match_reason': generate_match_reason(resource, module, score_data)
            })

    # Sort resources by priority within each type
    for module_id in current_resources['resources']:
        for resource_type in current_resources['resources'][module_id]:
            current_resources['resources'][module_id][resource_type].sort(
                key=lambda x: (x.get('priority', 5), x['title'])
            )

    return current_resources
```

**4.2 Validate YAML Structure**
```bash
# Syntax check
yq '.' docs/resources/external_resources.yaml > /dev/null

# Check for duplicates
yq '.resources | to_entries | .[].value | to_entries | .[].value[] | .url' \
  docs/resources/external_resources.yaml | sort | uniq -d
```

---

### Phase 5: Update Generation Scripts (30 minutes)

**Modify sorting logic to use priority field:**

**File:** `scripts/generate_mdx.py` (line ~1660)

**Current:**
```python
sorted_items = sorted(
    items,
    key=lambda x: (-relevance_priority.get(x.get('relevance', 'low'), 0),
                   x.get('title', '').lower())
)
```

**NEW:**
```python
priority_map = {1: 5, 2: 4, 3: 3, 4: 2, 5: 1}  # 1 = highest
relevance_map = {'high': 3, 'medium': 2, 'low': 1}

sorted_items = sorted(
    items,
    key=lambda x: (
        -priority_map.get(x.get('priority', 5), 1),      # Priority first (ULP = 1-2)
        -relevance_map.get(x.get('relevance', 'low'), 0), # Then relevance
        x.get('title', '').lower()                        # Then alphabetical
    )
)
```

**Same change for `scripts/generate_json.py`**

---

### Phase 6: Quality Control & Validation (1 hour)

**6.1 Coverage Metrics**
```bash
# Count modules with ULP podcast episodes (priority 1-2)
yq '.resources | to_entries | map(select(.value.podcasts[]?.priority <= 2)) | length' \
  docs/resources/external_resources.yaml

# Count modules with ULP blog articles (priority 1-2)
yq '.resources | to_entries | map(select(.value.articles[]?.priority <= 2)) | length' \
  docs/resources/external_resources.yaml

# List ULP episodes NOT mapped anywhere
# (compare podcast_db.json vs. external_resources.yaml)
```

**6.2 Test Generated Output**
```bash
# Regenerate sample modules
npm run generate l2-uk-en a1 1 9 11 17

# Verify ULP appears first in output
tail -30 docusaurus/docs/a1/module-09.mdx | grep -A 20 "Podcasts:"

# Expected: ULP episodes first, then other podcasts
```

**6.3 Validation Checklist**
- ✅ All 240 ULP episodes mapped at least once (or flagged as "no good match")
- ✅ All 28 blog articles mapped at least once
- ✅ Priority 1 resources are genuinely critical (manual spot-check)
- ✅ Priority sorting works (ULP appears first in generated MDX)
- ✅ YAML structure valid
- ✅ No broken URLs (spot-check 10%)
- ✅ No duplicate mappings within same module

---

### Checkpoint Strategy

**Review gates every 50 resources:**
- After 50 resources: Review Priority 1 assignments
- After 100 resources: Check unmapped resources (any good matches missed?)
- After 150 resources: Validate YAML structure
- After 200 resources: Test sample MDX generation
- After 268 resources: Full validation suite

**Track progress:**
```bash
# Create progress tracker
echo "Resources mapped: 0/268" > mapping_progress.txt
echo "Priority 1: 0" >> mapping_progress.txt
echo "Priority 2: 0" >> mapping_progress.txt
echo "Priority 3+: 0" >> mapping_progress.txt
echo "Unmapped: 268" >> mapping_progress.txt

# Update after each checkpoint
```

---

## 5. Success Criteria

**Upon completion, the system must:**

✅ **Coverage:**
- A1: ≥25 modules (74%+) have ULP content at Priority 1-2
- A2: ≥35 modules (61%+) have ULP content at Priority 1-2
- B1: ≥40 modules (44%+) have ULP content at Priority 1-2
- B2: ≥20 modules (14%+) have ULP content at Priority 1-2

✅ **Quality:**
- All Priority 1 mappings manually verified (no false positives)
- ≥90% of ULP episodes mapped to at least one module
- ≥95% of blog articles mapped to at least one module

✅ **Display Order:**
- Generated MDX shows ULP resources FIRST in podcast sections
- ULP blog articles appear FIRST in article sections
- Priority sorting works correctly (1 → 2 → 3 → 4 → 5)

✅ **Technical:**
- external_resources.yaml validates (YAML syntax)
- No duplicate mappings within same module
- All URLs accessible (spot-check 10%)
- Generation scripts updated and tested

---

## 6. Timeline

| Phase | Task | Duration | Checkpoint |
|-------|------|----------|------------|
| **0** | User approval of methodology | 30 min | Review this document |
| **1** | Data preparation | 30 min | module_metadata.json created |
| **2** | Automated scoring | 2 hours | resource_module_scores.json created |
| **3** | Manual review | 1-2 hours | Priority 1 verified, samples checked |
| **4** | Update YAML | 1 hour | external_resources.yaml updated |
| **5** | Update scripts | 30 min | generate_mdx.py, generate_json.py modified |
| **6** | Validation | 1 hour | Coverage metrics, output tests pass |
| **Total** | **5-6.5 hours** | After user approval |

---

## 7. Next Steps

**User Action Required:**
1. **Review this methodology document**
2. **Approve or request revisions** to priority definitions, scoring criteria, or automation approach
3. **Approve execution** → Proceed with Phases 1-6

**Upon approval:**
- Execute automated scoring (Phase 2)
- Manual review Priority 1 assignments (Phase 3)
- Update external_resources.yaml (Phase 4)
- Update generation scripts (Phase 5)
- Validate and test (Phase 6)

**Questions for user:**
- Are the 5 priority levels clear and appropriate?
- Should we adjust the relevance score thresholds (currently 30-44 = Priority 5, etc.)?
- Any specific ULP episodes or blog articles you want prioritized differently?
- Should we map resources to multiple modules (e.g., beginner episodes as "review" in advanced modules)?

---

**Status:** ⏸️ **Awaiting user approval**

**Document version:** 1.0 (2026-01-02)
