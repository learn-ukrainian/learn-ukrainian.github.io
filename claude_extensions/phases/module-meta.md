# Phase 1: module-meta

Create the module metadata sidecar file (`meta/{slug}.yaml`).

## Usage

```
/module-meta {level} {module_num}
```

## Input Required

1. **Curriculum plan**: `docs/l2-uk-en/{LEVEL}-CURRICULUM-PLAN.md`
2. **Module position**: Which module number in the sequence
3. **Previous vocabulary**: For tracks, cumulative from A1→B2 core

## Output

Single file: `curriculum/l2-uk-en/{level}/meta/{slug}.yaml`

## Schema

```yaml
# Required fields
module: {level}-{num}           # e.g., b2-hist-01
id: {level}-{num}
title: "Назва українською"      # Ukrainian title
subtitle: "English subtitle"
slug: {slug}                    # kebab-case, no numbers for tracks
version: '2.0'
phase: {phase from plan}        # e.g., B2-HIST.1 [Витоки]
focus: history|grammar|vocabulary|cultural|biography|integration
pedagogy: seminar|TTT|PPP|CLIL
register: публіцистичний|науковий|розмовний
duration: 150                   # minutes
transliteration: none           # for B2+

# Learning objectives (3-5, in Ukrainian)
objectives:
  - "Учень може [measurable verb]..."
  - "Учень може [measurable verb]..."

# Grammar focus (2-4 points)
grammar:
  - "Grammar point 1"
  - "Grammar point 2"

# Content structure with word targets
word_target: 4000               # total for LESSON CONTENT only
content_outline:                # Main lesson sections only
  - section: "Назва секції"
    words: 200
    points:
      - Key point 1
      - Key point 2

# IMPORTANT: content_outline contains ONLY lesson content sections
# EXCLUDE from content_outline:
#   - Activities (essays, quizzes) → go in activity_hints
#   - Practice recommendations → auto-generated by script
#   - Activity rubrics → go in activities.yaml

# Vocabulary guidance
vocabulary_hints:
  required:                     # Must appear in content
    - word1 (translation)
    - word2 (translation)
  recommended:                  # May appear
    - word3 (translation)

# Activity planning
activity_hints:
  - type: reading
    focus: "What to read"
    source: "Where from"
  - type: quiz
    focus: "What to test"
    items: 12+

# Sources (minimum 2)
sources:
  - name: "Source title"
    url: "https://..."
    type: reference|primary|academic
    notes: "Why this source"

# Module connections
prerequisites:
  - "What learner needs first"
connects_to:
  - "Related modules"
```

## YAML Safety Rules

**Critical formatting requirements:**

1. **Strings with colons MUST be double-quoted:**
   ```yaml
   title: "Козаки: епоха"        # ✓ CORRECT
   title: Козаки: епоха          # ✗ WRONG - YAML parse error
   ```

2. **Use «» not "" inside Ukrainian text:**
   ```yaml
   title: "Вона сказала: «Так»"  # ✓ CORRECT
   title: "Вона сказала: "Так""  # ✗ WRONG - JSX compilation error
   ```

3. **Quote version numbers:**
   ```yaml
   version: '2.0'                # ✓ CORRECT
   version: 2.0                  # ✗ WRONG - treated as float
   ```

4. **Arrays must have consistent indentation:**
   ```yaml
   objectives:                   # ✓ CORRECT
     - "First objective"
     - "Second objective"
   ```

5. **No unescaped special characters:** `#`, `:`, `{`, `}`, `[`, `]`, `&`, `*`, `!`, `|`, `>`, `'`, `"`, `%`, `@`, `` ` ``

## Required vs Optional Fields by Module Type

### Core Levels (A1-C1 core, C2)
**Required:**
- module, id, title, subtitle, slug, version, phase, focus, pedagogy, duration, transliteration
- objectives (3-5), grammar (2-4)
- word_target, content_outline
- vocabulary_hints, activity_hints

**Optional:**
- sources (not required for grammar/vocab modules)
- register (mainly for B2+)
- prerequisites, connects_to

### Track Levels (B2-HIST, C1-BIO, C1-HIST, LIT)
**Required:**
- All core fields PLUS:
- sources (minimum 2, academic quality)
- register (публіцистичний, науковий, etc.)
- prerequisites, connects_to

## Measurable Verbs for Objectives

**For core levels (grammar/vocab):** Use English or Ukrainian based on level
- A1-A2 (English): "Learner can describe...", "Learner can identify..."
- B1+ (Ukrainian): "Учень може описати...", "Учень може визначити..."

**For track levels (content-based):** Always Ukrainian
- Use Bloom's taxonomy verbs:
  - **Remember**: описати, визначити, перелічити, назвати
  - **Understand**: пояснити, узагальнити, порівняти
  - **Apply**: продемонструвати, використати, проілюструвати
  - **Analyze**: проаналізувати, диференціювати, дослідити
  - **Evaluate**: оцінити, аргументувати, обґрунтувати
  - **Create**: створити, розробити, сконструювати

## Word Targets by Level

| Level | Target Range | Notes |
|-------|-------------|-------|
| A1 | 300-750 | Graduated: M01-05 (300-450), M06-10 (500-650), M11+ (750+) |
| A2 | 1000-1500 | Core curriculum |
| B1 | 1500-2000 | Core curriculum |
| B2 (core) | 1750-2500 | Grammar/vocab modules |
| B2-HIST | 3000-5000 | History track |
| B2-PRO | 2000-3000 | Professional track |
| C1 (core) | 2000-3000 | Advanced grammar/vocab |
| C1-BIO | 4000-6000 | Biography track |
| C1-HIST | 4000-6000 | History track |
| LIT | 5000-8000 | Literature specialization |
| C2 | 2000-4000 | Mastery level |

## Process

1. Read the curriculum plan for this module
2. Extract title, phase, focus from plan
3. Write 3-5 measurable objectives in Ukrainian
4. Create content_outline with word targets (see algorithm below)
5. List vocabulary_hints from plan (required vs recommended)
6. Plan activity types matching pedagogy
7. Add 2+ credible sources
8. Write prerequisites and connections

## Word Target Allocation Algorithm

**Goal:** Distribute `word_target` across sections so they sum exactly.

**Steps:**

1. **Reserve intro/outro budget:**
   - Intro section: ~200 words (5% of typical 4000)
   - Summary (if separate): handled by module structure, not in outline

2. **Count total key_points:**
   - Go through all main sections
   - Sum up number of key_points items

3. **Calculate main budget:**
   ```
   main_budget = word_target - intro_words
   ```

4. **Allocate proportionally:**
   ```
   For each main section:
     section_words = round((section_key_points / total_key_points) × main_budget)
   ```

5. **Adjust final section to match exactly:**
   ```
   current_sum = sum(all_section_words)
   difference = word_target - current_sum
   last_section_words += difference
   ```

**Example (word_target = 4000):**

Sections with key_points:
- Intro: 2 points
- Early Years: 4 points
- Path to Uprising: 4 points
- Military Leader: 4 points
- Diplomat: 4 points
- Legacy: 4 points

Total key_points = 2 + 4 + 4 + 4 + 4 + 4 = 22

Allocation:
- Intro: 200 (fixed)
- Main budget: 4000 - 200 = 3800
- Early Years: round(4/22 × 3800) = 691 → 700
- Path: round(4/22 × 3800) = 691 → 700
- Military: round(4/22 × 3800) = 691 → 900 (adjusted)
- Diplomat: round(4/22 × 3800) = 691 → 800
- Legacy: round(4/22 × 3800) = 691 → 700

Sum: 200 + 700 + 700 + 900 + 800 + 700 = 4000 ✓

**Notes:**
- Round to nearest 50 or 100 for readability
- Adjust sections based on content importance (e.g., Military Leader gets more weight)
- Final check: sum MUST equal word_target exactly

## Validation (Next Phase)

This file will be validated by `module-meta-qa`. Do not proceed to content until meta passes QA.

## Example Command

```bash
# For B2-HIST module 5
/module-meta b2-hist 5
```

---

**Next phase:** `module-meta-qa` → validates this file before locking
