# Phase 3: module-lesson

Generate main lesson content from locked meta.yaml.

## Usage

```
/module-lesson {level} {module_num}
```

## Input

- `curriculum/l2-uk-en/{level}/meta/{slug}.yaml` (LOCKED from Phase 2)

## Output

- `curriculum/l2-uk-en/{level}/{slug}.md`

## Critical Rules

> [!IMPORTANT]
> ### Word Count Accuracy
>
> The PRIMARY goal of this phase is hitting word targets EXACTLY.
>
> **Process:**
> 1. Generate each section independently
> 2. Count words after EACH section
> 3. Adjust if needed BEFORE moving to next section
> 4. Final check: total must equal ¬±5% of word_target
>
> **Why this matters:**
> - LLMs struggle with overall word counts
> - Section-by-section generation with verification ensures accuracy
> - This is the ONLY way to reliably hit 4000+ word targets
>
> ### Content-Only Scope
>
> Generate ONLY main lesson content. DO NOT generate:
> - ‚ùå Activities (essays, quizzes, exercises) ‚Üí Phase 5
> - ‚ùå Vocabulary tables ‚Üí Phase 7
> - ‚ùå Practice recommendations ‚Üí auto-generated by script
> - ‚úì Main narrative/explanation
> - ‚úì Examples within text
> - ‚úì Engagement boxes
> - ‚úì Primary source excerpts (for history modules)
>
> ### Vocabulary Usage
>
> Use ONLY vocabulary from `vocabulary_hints`:
> - **required**: MUST appear in content
> - **recommended**: MAY appear if contextually appropriate
>
> DO NOT add vocabulary outside these lists. Vocabulary scope is pre-planned.

---

## Content Generation Process

### Step 1: Load Meta and Template

1. Read meta.yaml:
   ```bash
   curriculum/l2-uk-en/{level}/meta/{slug}.yaml
   ```

2. Read appropriate template:
   - **A1**: `docs/l2-uk-en/templates/a1-module-template.md`
   - **A2**: `docs/l2-uk-en/templates/a2-module-template.md`
   - **B1**: `docs/l2-uk-en/templates/b1-grammar-module-template.md` (or cultural/vocabulary based on focus)
   - **B2 core**: `docs/l2-uk-en/templates/b2-grammar-module-template.md` (or others)
   - **B2-HIST**: `docs/l2-uk-en/templates/b2-history-module-template.md`
   - **B2-PRO**: `docs/l2-uk-en/templates/b2-pro-module-template.md`
   - **C1-BIO**: `docs/l2-uk-en/templates/c1-biography-module-template.md`
   - **LIT**: `docs/l2-uk-en/templates/lit-module-template.md`

3. Read quality standards:
   ```
   docs/l2-uk-en/MODULE-RICHNESS-GUIDELINES-v2.md
   ```

### Step 2: Generate Frontmatter

Create YAML frontmatter from meta.yaml:

```yaml
---
module: {module}
title: '{title}'
subtitle: '{subtitle}'
version: '{version}'
phase: '{phase}'
pedagogy: '{pedagogy}'
focus: '{focus}'
duration: {duration}
transliteration: {transliteration}
register: '{register}'  # if present
tags:
  - {derived from focus and phase}
---
```

### Step 3: Generate SCOPE Comment

For all modules, add SCOPE comment after frontmatter:

```markdown
<!-- SCOPE
Covers: [What this module teaches - from objectives]
Not covered:
  - [Related topic] ‚Üí {slug}
  - [Related topic] ‚Üí {slug}
Related: [connected slugs from meta.connects_to]
-->
```

### Step 4: Generate Title and Introduction

**Title (H1):**
```markdown
# {title from meta}
```

**Introduction Hook (optional but recommended for B1+):**

Based on pedagogy and focus:

**For history/cultural modules (B2+):**
```markdown
> **–ß–æ–º—É —Ü–µ –≤–∞–∂–ª–∏–≤–æ?**
>
> [2-3 sentences explaining historical/cultural significance]
> [Connection to modern Ukraine or learner's context]
```

**For grammar modules:**
```markdown
> **üéØ –ú–µ—Ç–∞ –º–æ–¥—É–ª—è**
>
> [What learner will be able to do after this lesson]
```

### Step 5: Generate Content Sections

**CRITICAL: Section-by-section generation with word count verification**

For each section in `content_outline`:

1. **Read section requirements:**
   - `section`: Ukrainian heading
   - `words`: Target word count
   - `points`: Key points to cover

2. **Generate section content:**
   ```markdown
   ## {section name}

   [Content covering all points, hitting word target]
   ```

3. **Apply level-specific requirements:**

   **Engagement Boxes** (from MODULE-RICHNESS-GUIDELINES-v2.md):
   - A1: 3+ per module
   - A2: 4+ per module
   - B1: 5+ per module
   - B2: 6+ per module
   - C1: 7+ per module
   - C2: 8+ per module

   Use callout types based on content:
   - `[!tip]` - Grammar tips, learning strategies
   - `[!history-bite]` - Historical facts (history modules)
   - `[!myth-buster]` - Decolonization content (history modules)
   - `[!culture]` - Cultural context
   - `[!quote]` - Primary sources (history modules)
   - `[!warning]` - Common mistakes

   **Example Sentences** (from MODULE-RICHNESS-GUIDELINES-v2.md):
   - A1: 12+ per module
   - A2: 18+ per module
   - B1: 24+ per module
   - B2: 24+ per module
   - C1: 30+ per module
   - C2: 32+ per module

   Format:
   ```markdown
   _–ü—Ä–∏–∫–ª–∞–¥:_ ¬´{Ukrainian sentence}¬ª
   ```

   **Mini-Dialogues** (for grammar/vocab modules, NOT history):
   - A1: 2+ per module
   - A2: 3+ per module
   - B1: 4+ per module
   - B2: 4+ per module
   - C1: 5+ per module
   - C2: 5+ per module

   Format:
   ```markdown
   **–î—ñ–∞–ª–æ–≥:**
   - –ê: {line}
   - –ë: {line}
   ```

4. **Count words immediately:**
   ```
   Section actual: {count} words
   Section target: {words} words
   Difference: {count - words}
   ```

5. **Adjust if needed:**
   - If under target: Expand with more examples, context, or detail
   - If over target: Tighten prose or move content to next section
   - Goal: ¬±10% of section target

6. **Move to next section** only after current section is accurate

### Step 6: Generate Summary

After all content sections, add summary:

```markdown
---

# –ü—ñ–¥—Å—É–º–æ–∫

[3-4 paragraph summary covering:
- Main topic reviewed
- Key grammar/vocabulary/concepts learned
- Connection to broader context
- Next steps or related topics
]

---
```

**Summary word count:** ~150-200 words (NOT counted toward word_target)

### Step 7: Verify Total Word Count

**Final check:**

```
Total content words: {sum of all section words}
Target: {word_target}
Percentage: {(total/target) * 100}%
Status: PASS if 95-105% of target
```

If outside range: Adjust largest section(s) to compensate.

---

## Pedagogy-Specific Content Patterns

### PPP (Presentation-Practice-Production)

**Used in:** A1-A2 grammar modules

**Content structure:**
- **Warm-up/Presentation:** Introduce concept with context
- **Examples:** Show pattern with multiple examples
- **Explanation:** Grammar rule in simple terms
- **Practice:** Guided examples (activities go in Phase 5)

**Immersion:**
- A1: 10-40% Ukrainian (graduated)
- A2: 40-75% Ukrainian (graduated by phase)

### TTT (Test-Teach-Test)

**Used in:** A2-B1 grammar modules

**Content structure:**
- **Diagnostic:** Start with challenge to reveal gap
- **Analysis:** Examine the grammar problem
- **Deep Dive:** Detailed explanation with examples
- **Grammar in Context:** Show natural usage

**Immersion:**
- B1+: 100% Ukrainian

### Seminar (Content-Based)

**Used in:** B2-HIST, C1-BIO, C1-HIST, LIT

**Content structure:**
- **–í—Å—Ç—É–ø:** Context and significance
- **–ß–∏—Ç–∞–Ω–Ω—è:** Extended narrative (500+ words for history)
- **–ü–µ—Ä–≤–∏–Ω–Ω—ñ –¥–∂–µ—Ä–µ–ª–∞:** Primary source excerpts with analysis
- **–ê–Ω–∞–ª—ñ–∑/–û–±–≥–æ–≤–æ—Ä–µ–Ω–Ω—è:** Critical analysis section
- **–î–µ–∫–æ–ª–æ–Ω—ñ–∑–∞—Ü—ñ–π–Ω–∏–π –ø–æ–≥–ª—è–¥:** Ukraine-centric perspective (history only)

**Special requirements:**
- Minimum 2 primary sources in `[!quote]` callouts
- Extended paragraphs (100-200 words each)
- Academic register
- Source citations

**Immersion:** 100% Ukrainian

### CLIL (Content and Language Integrated)

**Used in:** B1 cultural modules

**Content structure:**
- **Introduction:** Topic overview
- **Narrative:** Cultural content
- **Grammar in Context:** Show grammar naturally in content
- **Cultural Analysis:** Deeper understanding

**Immersion:** 100% Ukrainian

---

## Level-Specific Guidelines

### A1 Modules

**Word Target:** 300-750 (graduated)
- M01-05: 300-450 words
- M06-10: 500-650 words
- M11-34: 750+ words

**Immersion:** 10-40% (graduated)
- Heavy English for phonetics, explanations
- Ukrainian for examples being taught

**Content focus:**
- Clear phonetic explanations
- Letter/sound relationships
- International words
- Simple vocabulary presentation

**Objectives language:** English
- "Learner can recognize..."
- "Learner can pronounce..."

### A2 Modules

**Word Target:** 1000-1500

**Immersion:** 40-75% (graduated)
- A2.1: 40-50%
- A2.2: 50-65%
- A2.3: 65-75%

**Content focus:**
- Case system introduction
- Aspect basics
- Practical scenarios

**Objectives language:** English
- "Learner can use..."
- "Learner can distinguish..."

### B1+ Modules

**Word Target:** 1500-2000 (core), higher for tracks

**Immersion:** 100% Ukrainian
- ALL content in Ukrainian
- Grammar explanations in Ukrainian
- Grammar metalanguage as vocabulary

**Content focus:**
- Complex grammar IN Ukrainian
- Cultural content
- Extended reading

**Objectives language:** Ukrainian
- "–£—á–µ–Ω—å –º–æ–∂–µ –æ–ø–∏—Å–∞—Ç–∏..."
- "–£—á–µ–Ω—å –º–æ–∂–µ –ø—Ä–æ–∞–Ω–∞–ª—ñ–∑—É–≤–∞—Ç–∏..."

---

## Quality Standards

### Ukrainian Language Quality

1. **No Surzhyk:** Zero tolerance
2. **No Russian interference:** Check vocabulary against Goroh, –°–ª–æ–≤–Ω–∏–∫.ua
3. **Active voice:** Prefer active over passive constructions
4. **Natural flow:** No robotic transitions, no template repetition
5. **Discourse markers:** Use connectors (–∞, –∞–ª–µ, —Ç–æ–º—É, —Ç–∞–∫–æ–∂, —Å–ø–æ—á–∞—Ç–∫—É, –Ω–∞—Ä–µ—à—Ç—ñ)

### Content Quality

1. **Accuracy:** All historical/cultural facts must be verifiable from sources
2. **Decolonization:** Ukraine-centric perspective (not Russian imperial framing)
3. **Engagement:** Use storytelling, not dry exposition
4. **Examples:** Diverse, realistic, culturally appropriate
5. **Grammar:** Demonstrate points naturally, not artificially

### Formatting

1. **Headings:** Use H2 (##) for main sections from content_outline
2. **Callouts:** Use `[!type]` format with proper types
3. **Emphasis:** Use **bold** for key terms, _italic_ for Ukrainian in English context
4. **Lists:** Use `-` for unordered, `1.` for ordered
5. **Horizontal rules:** Use `---` to separate major sections

---

## Output Format

```markdown
---
{YAML frontmatter}
---

<!-- SCOPE
{scope comment}
-->

# {Title}

> {Introduction hook if appropriate}

## {Section 1 from content_outline}

{Content hitting section word target}

{Engagement boxes}
{Examples}
{Mini-dialogues if appropriate}

## {Section 2}

{Content...}

[... all sections from content_outline ...]

---

# –ü—ñ–¥—Å—É–º–æ–∫

{Summary}

---
```

---

## Validation Checklist

Before outputting, verify:

- [ ] All sections from content_outline generated
- [ ] Each section hits ¬±10% of word target
- [ ] Total word count is 95-105% of meta.word_target
- [ ] Engagement boxes meet level minimum
- [ ] Example sentences meet level minimum
- [ ] Mini-dialogues included (if grammar/vocab module)
- [ ] All required vocabulary used
- [ ] No vocabulary outside hints lists
- [ ] Grammar points demonstrated
- [ ] Immersion % matches level requirements
- [ ] Objectives language matches level (English A1-A2, Ukrainian B1+)
- [ ] No activities/exercises included (those are Phase 5)
- [ ] No vocabulary tables (those are Phase 7)
- [ ] YAML frontmatter complete
- [ ] SCOPE comment present

---

## Next Phase

On completion, output:

```
LESSON GENERATED: curriculum/l2-uk-en/{level}/{slug}.md

Word count breakdown:
- Section 1: {count}/{target} words
- Section 2: {count}/{target} words
...
- Total: {total}/{word_target} words ({percentage}%)

‚úì Engagement boxes: {count} (min: {level_min})
‚úì Example sentences: {count} (min: {level_min})
‚úì Immersion: {percentage}% (target: {level_target})

Next: Run /module-lesson-qa {level} {module_num}
```

---

**Phase output is UNLOCKED until Phase 4 QA passes.**
